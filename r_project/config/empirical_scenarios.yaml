# ==================================
# Empirical Scenarios Configuration
# ==================================
# This YAML file defines all empirical estimation scenarios.
# Each scenario specifies data sources and estimation settings.
#
# Usage:
#   source("run_empirical_study.R")
#   run_empirical_study(scenario_ids = c("fw_no_cv", "ew_cv"))

# Default values inherited by all scenarios unless overridden
defaults:
  private_source: "preqin"
  public_filename: "q_factors"
  data_prepared_folder: "data_prepared_2026"
  cutoff: ""
  sdf_model: "linear"
  error_function: "L2_Lasso"
  include_alpha_term: false
  use_vintage_year_pfs: true
  max_months: [0, 1, 30, 60, 120, 150, 180, 210, 240, 270, 300, 330, 360]
  lambdas: 0
  kernel_bandwidth: 12
  alpha_lower: -0.02
  alpha_upper: 0.02
  part_to_keep: 1
  no_partitions: 1
  max_vintage: 2021
  data_out_folder: "results/data_out_2026-emp"

# ============================================================================
# ONE-FACTOR MODELS (Market Beta Only)
# ============================================================================

scenarios:
  # --------------------------------------------------------------------------
  # Fund-Weighted Scenarios
  # --------------------------------------------------------------------------
  fw_no_cv:
    description: "Fund-weighted VYP, no cross-validation"
    weighting: "FW"
    do_cross_validation: false
    factors_to_use: ""
    active: true
  
  fw_cv:
    description: "Fund-weighted VYP, with cross-validation"
    weighting: "FW"
    do_cross_validation: true
    factors_to_use: ""
    active: true
  
  # --------------------------------------------------------------------------
  # Equal-Weighted Scenarios
  # --------------------------------------------------------------------------
  ew_no_cv:
    description: "Equal-weighted VYP, no cross-validation"
    weighting: "EW"
    do_cross_validation: false
    factors_to_use: ""
    active: true
  
  ew_cv:
    description: "Equal-weighted VYP, with cross-validation"
    weighting: "EW"
    do_cross_validation: true
    factors_to_use: ""
    active: true

# ============================================================================
# TWO-FACTOR MODELS (Market Beta + Second Factor)
# ============================================================================
  
  # --------------------------------------------------------------------------
  # Fund-Weighted + Second Factor
  # --------------------------------------------------------------------------
  fw_no_cv_alpha:
    description: "Fund-weighted VYP, no CV, estimate α"
    weighting: "FW"
    do_cross_validation: false
    factors_to_use: "Alpha"
    active: false
  
  fw_no_cv_ME:
    description: "Fund-weighted VYP, no CV, estimate ME"
    weighting: "FW"
    do_cross_validation: false
    factors_to_use: "ME"
    active: false
  
  fw_no_cv_IA:
    description: "Fund-weighted VYP, no CV, estimate IA"
    weighting: "FW"
    do_cross_validation: false
    factors_to_use: "IA"
    active: false
  
  fw_no_cv_ROE:
    description: "Fund-weighted VYP, no CV, estimate ROE"
    weighting: "FW"
    do_cross_validation: false
    factors_to_use: "ROE"
    active: false
  
  fw_no_cv_EG:
    description: "Fund-weighted VYP, no CV, estimate EG"
    weighting: "FW"
    do_cross_validation: false
    factors_to_use: "EG"
    active: false
  
  # --------------------------------------------------------------------------
  # Equal-Weighted + Second Factor
  # --------------------------------------------------------------------------
  ew_no_cv_alpha:
    description: "Equal-weighted VYP, no CV, estimate α"
    weighting: "EW"
    do_cross_validation: false
    factors_to_use: "Alpha"
    active: false
  
  ew_no_cv_ME:
    description: "Equal-weighted VYP, no CV, estimate ME"
    weighting: "EW"
    do_cross_validation: false
    factors_to_use: "ME"
    active: false
  
  ew_no_cv_IA:
    description: "Equal-weighted VYP, no CV, estimate IA"
    weighting: "EW"
    do_cross_validation: false
    factors_to_use: "IA"
    active: false
  
  ew_no_cv_ROE:
    description: "Equal-weighted VYP, no CV, estimate ROE"
    weighting: "EW"
    do_cross_validation: false
    factors_to_use: "ROE"
    active: false
  
  ew_no_cv_EG:
    description: "Equal-weighted VYP, no CV, estimate EG"
    weighting: "EW"
    do_cross_validation: false
    factors_to_use: "EG"
    active: false

# ============================================================================
# MAX VINTAGE SWEEP (Robustness: estimate for each max vintage year)
# ============================================================================

  fw_vintage_sweep:
    description: "FW VYP, no CV, max vintage 2011–2021"
    weighting: "FW"
    do_cross_validation: false
    factors_to_use: ""
    max_vintages: [2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021]
    active: false

  ew_vintage_sweep:
    description: "EW VYP, no CV, max vintage 2011–2021"
    weighting: "EW"
    do_cross_validation: false
    factors_to_use: ""
    max_vintages: [2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021]
    active: false

# ============================================================================
# FAMA-FRENCH 3 FACTOR MODELS
# ============================================================================

  # --------------------------------------------------------------------------
  # One-Factor (MKT only, using FF3 data source)
  # --------------------------------------------------------------------------
  ff3_fw_no_cv:
    description: "FF3 data, fund-weighted VYP, no CV (MKT-only)"
    public_filename: "ff3_factors"
    weighting: "FW"
    do_cross_validation: false
    factors_to_use: ""
    active: true

  ff3_ew_no_cv:
    description: "FF3 data, equal-weighted VYP, no CV (MKT-only)"
    public_filename: "ff3_factors"
    weighting: "EW"
    do_cross_validation: false
    factors_to_use: ""
    active: true

  # --------------------------------------------------------------------------
  # Two-Factor: MKT + SMB
  # --------------------------------------------------------------------------
  ff3_fw_no_cv_SMB:
    description: "FF3 data, fund-weighted VYP, no CV, MKT+SMB"
    public_filename: "ff3_factors"
    weighting: "FW"
    do_cross_validation: false
    factors_to_use: "SMB"
    active: false

  ff3_ew_no_cv_SMB:
    description: "FF3 data, equal-weighted VYP, no CV, MKT+SMB"
    public_filename: "ff3_factors"
    weighting: "EW"
    do_cross_validation: false
    factors_to_use: "SMB"
    active: false

  # --------------------------------------------------------------------------
  # Two-Factor: MKT + HML
  # --------------------------------------------------------------------------
  ff3_fw_no_cv_HML:
    description: "FF3 data, fund-weighted VYP, no CV, MKT+HML"
    public_filename: "ff3_factors"
    weighting: "FW"
    do_cross_validation: false
    factors_to_use: "HML"
    active: false

  ff3_ew_no_cv_HML:
    description: "FF3 data, equal-weighted VYP, no CV, MKT+HML"
    public_filename: "ff3_factors"
    weighting: "EW"
    do_cross_validation: false
    factors_to_use: "HML"
    active: false

  # --------------------------------------------------------------------------
  # Two-Factor: Alpha + MKT (FF3 data)
  # --------------------------------------------------------------------------
  ff3_fw_no_cv_alpha:
    description: "FF3 data, fund-weighted VYP, no CV, Alpha+MKT"
    public_filename: "ff3_factors"
    weighting: "FW"
    do_cross_validation: false
    factors_to_use: "Alpha"
    include_alpha_term: true
    active: false  # Redundant: Alpha is already handled by include_alpha_term

  ff3_ew_no_cv_alpha:
    description: "FF3 data, equal-weighted VYP, no CV, Alpha+MKT"
    public_filename: "ff3_factors"
    weighting: "EW"
    do_cross_validation: false
    factors_to_use: "Alpha"
    include_alpha_term: true
    active: false  # Redundant: Alpha is already handled by include_alpha_term

  ff3_fw_cv_alpha:
    description: "FF3 data, fund-weighted VYP, CV, Alpha+MKT"
    public_filename: "ff3_factors"
    weighting: "FW"
    do_cross_validation: true
    factors_to_use: "Alpha"
    include_alpha_term: true
    active: false  # Deactivated: run after verifying no-CV first

  ff3_ew_cv_alpha:
    description: "FF3 data, equal-weighted VYP, CV, Alpha+MKT"
    public_filename: "ff3_factors"
    weighting: "EW"
    do_cross_validation: true
    factors_to_use: "Alpha"
    include_alpha_term: true
    active: false  # Deactivated: run after verifying no-CV first
  
  # --------------------------------------------------------------------------
  # Three-Factor: MKT + SMB + HML (FF3 data)
  # --------------------------------------------------------------------------
  ff3_fw_no_cv_ALL_3f:
    description: "FF3 data, fund-weighted VYP, no CV, MKT+SMB+HML"
    public_filename: "ff3_factors"
    weighting: "FW"
    do_cross_validation: false
    factors_to_use: ["MKT", "SMB", "HML"]
    include_alpha_term: false
    active: true

  ff3_ew_no_cv_ALL_3f:
    description: "FF3 data, equal-weighted VYP, no CV, MKT+SMB+HML"
    public_filename: "ff3_factors"
    weighting: "EW"
    do_cross_validation: false
    factors_to_use: ["MKT", "SMB", "HML"]
    include_alpha_term: false
    active: true
    
  # --------------------------------------------------------------------------
  # Four-Factor: Alpha + MKT + SMB + HML (FF3 data)
  # --------------------------------------------------------------------------
  ff3_fw_no_cv_ALL:
    description: "FF3 data, fund-weighted VYP, no CV, Alpha+MKT+SMB+HML"
    public_filename: "ff3_factors"
    weighting: "FW"
    do_cross_validation: false
    factors_to_use: "ALL"
    include_alpha_term: true
    active: true

  ff3_ew_no_cv_ALL:
    description: "FF3 data, equal-weighted VYP, no CV, Alpha+MKT+SMB+HML"
    public_filename: "ff3_factors"
    weighting: "EW"
    do_cross_validation: false
    factors_to_use: "ALL"
    include_alpha_term: true
    active: true
    
  ff3_fw_cv_ALL:
    description: "FF3 data, fund-weighted VYP, CV, Alpha+MKT+SMB+HML"
    public_filename: "ff3_factors"
    weighting: "FW"
    do_cross_validation: true
    factors_to_use: "ALL"
    include_alpha_term: true
    active: true

  ff3_ew_cv_ALL:
    description: "FF3 data, equal-weighted VYP, CV, Alpha+MKT+SMB+HML"
    public_filename: "ff3_factors"
    weighting: "EW"
    do_cross_validation: true
    factors_to_use: "ALL"
    include_alpha_term: true
    active: true
    
# ============================================================================
# ALTERNATIVE DATA SOURCES
# ============================================================================

  pitchbook_fw_no_cv:
    description: "PitchBook data, fund-weighted, no CV"
    private_source: "pitchbook"
    weighting: "FW"
    do_cross_validation: false
    factors_to_use: ""
    active: false
  
  pitchbook_ew_no_cv:
    description: "PitchBook data, equal-weighted, no CV"
    private_source: "pitchbook"
    weighting: "EW"
    do_cross_validation: false
    factors_to_use: ""
    active: false
