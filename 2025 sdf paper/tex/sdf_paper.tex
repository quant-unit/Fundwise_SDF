
\documentclass[12pt]{article}

\title{Semiparametric SDF Estimators \\ for Pooled, Non-Traded Cash Flows}

\author{
	Christian Tausch  \\
	AssetMetrix GmbH  \\
	Theresienh\"{o}he 13, D-80339 Munich \\
	christian.tausch@quant-unit.com \\
	\and 
	Alexander Bohnert  \\
	Munich University of Applied Sciences \\
	Am Stadtpark 20, D-81243 Munich \\
	alexander.bohnert@hm.edu \\
}

\date{\today}



% Packages
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{natbib}
\usepackage{graphics}
% use smaller margins
\usepackage[margin=1.1in]{geometry} % 1.25in
\usepackage[margin=1.1cm]{caption}
% use double spacing
\usepackage{setspace}
\usepackage{amsthm}
\usepackage{url}
\usepackage[outdir=./]{epstopdf}
\usepackage{booktabs}
\usepackage{float}
\usepackage{standalone}
\usepackage{xcolor}
\usepackage{tabularx}
\usepackage{longtable}
\usepackage{tcolorbox}

\newtheorem{assume}{Assumption}
\newtheorem{lemma}{Lemma}
\newtheorem{proposition}{Proposition}
\newtheorem{corollary}{Corollary}
\newtheorem{remark}{Remark}
\newtheorem{definition}{Definition}
\newtheorem{example}{Example}
\newtheorem{theorem}{Theorem}


% logo
\usepackage{fancyhdr}
\usepackage{graphicx }



\begin{document}
	
\maketitle


\section*{Keywords}
Stochastic Discount Factor,
Semiparametric Estimation,
Spatial Dependence,
Generalized Method of Moments (GMM),
Private Equity,
Illiquid Assets


\section*{Acknowledgements}
We thank Nicolas D\"{u}tsch, Philipp Abel, and Kai Urban for valuable feedback and helpful comments that greatly improved the paper.
%Further, we want to thank Jingzhi Huang, the editor, and two anonymous referees for their inspiring suggestions that helped to significantly improve the depth and robustness of our paper.


\section*{Declaration of interest}
The authors report no conflict of interest. 
The authors alone are responsible for the content and writing of the paper.


\newpage
%\doublespacing

\begin{center} 
	\section*{Semiparametric SDF Estimators \\ for Pooled, Non-Traded Cash Flows}
\end{center}



\abstract{
	This paper analyzes stochastic discount factor estimation methodologies suited for pooled, non-traded cash flow streams such as the fund-level cash flows of private equity funds.
	The asymptotic inference framework for our semiparametric nonlinear least squares estimator draws on a spatial notion, i.e., the idea that the economic distance between distinct private equity funds can be measured.
	The empirical and Monte Carlo simulation results indicate (i) that our method can improve the popular Generalized Method of Moments approach of \cite{DLP12}, but (ii) that estimator variance for typical data sizes is still high.
	Thus, we conjecture that traditional semiparametric extremum estimators like the one described by us shall be exclusively used for single-factor models until considerably more vintage year information for private equity funds is available.
}


%% main text
\section{Introduction}

Private equity has outgrown its niche, sitting today on more than \$9 trillion in assets under management, yet rigorous asset-pricing tools have not kept pace with this ascent.
The empirical analysis and risk assessment of private equity and other non-traded cash flows remain fundamentally challenging due to the absence of market-based valuations and the inherent frictions of private markets (i.e., under incomplete information). 
Unlike public assets with trusted and tradeable valuations (in liquid secondary markets), private equity investments generate irregular, infrequently observed cash flows for which standard return-based asset pricing techniques are unsuitable.

We address this gap by proposing a semiparametric stochastic discount factor (SDF) estimator tailored to fund-level cash flows that refines the SDF estimators of \cite{DLP12} and \cite{KN16}.
Our nonlinear least squares estimator stems from the class of Least-Mean-Distance (LMD) estimators, which are easier to handle than traditional Generalized Method of Moments (GMM) approaches \citep{PP97}.
Our LMD estimator arguably both simplifies and generalizes the GMM methodology of \cite{DLP12}, where we provide the asymptotic inference framework that was missing in the original paper.
The asymptotic inference formulations rely on the concept of spatial (near-epoch) dependence between funds as proposed by \cite{KN16}.
In this context, it is paramount to quantify the economic distance between funds by a measure like absolute vintage year difference or cash flow overlap\footnote{However, this economic inter-fund \emph{distance} refers \textbf{not} to the term Least-Mean-\emph{Distance} estimator.}.

For fund-level cash flow data of private equity funds, we document an asymptotic bias term for cash-flow-based SDF estimators like \cite{DLP12} and \cite{KN16} that persists also in large samples.
The bias term arises due to the pooled nature of fund-level cash flows and more specifically because of the different starting dates of the underlying deals (in the fund investment period).
Our estimator offers simple averaging over multiple discounting dates as one option to control (but not eliminate) the bias term.

In the empirical application of our new estimator, we test simple linear and exponentially affine SDF models that can draw on the five return factors associated with the $q^5$ investment factor model recently proposed by \cite{HXZ20}.
Based on a Spatial Heteroskedasticity and Autocorrelation Consistent (SHAC) covariance matrix estimator, we calculate asymptotic standard errors for the model coefficients.
Moreover, we assess the small-sample variance of coefficient estimates and the out-of-sample performance of the different SDF models by $hv$-block cross-validation, which accounts for the inter-vintage-year dependence of private equity funds \citep{R00}.
We test one- and two-factor models for the most prominent private capital fund types Private Equity (PE) and Venture Capital (VC).
The empirical two-factor model results are rather disappointing; not more than the single-market-factor model results seem reasonable given the high estimator variance.

The paper is structured as follows. 
% Section \ref{sec:literature} reviews the related literature.
Section \ref{sec:spatial_sdf_methodology} introduces our semiparametric LMD estimator and its corresponding asymptotic inference framework.
Section \ref{sec:empirical_application} applies the method to estimate $q^5$-investment-factor SDFs for various private equity fund types using simulated and real-world cash flows.
Section \ref{sec:spatial_sdf_conclusion} concludes.



\section{Methodology}
\label{sec:spatial_sdf_methodology}

Our general SDF estimation framework is similar to that of \cite{DLP12} and \cite{KN16}; 
the subtle but important differences are discussed in Section \ref{sec:comparison_to_similar_estimators}.

In a nutshell, the \cite{DLP12} estimator determines the estimated alpha and beta parameters of a linear factor model by minimizing the squared net present value (NPV) of all $n$ fund cash flows in a least-squares optimization problem.
\begin{equation}
	\label{eq:dlp12_minimization}
 	\left(\hat{\alpha}, \hat{\beta} \right) = 
 	\arg \min_{\alpha,\beta} \sum_{i=1}^n \left[ {NPV}_i(\alpha,\beta) \right]^2
\end{equation}
with $NPV$ for the $i$th fund
\[
{NPV}_i(\alpha,\beta) =
\sum_{t \in \left\{ t_{0,i}, t_{0,i} + 1, \dots \right\}}
\frac{\mathrm{CashFlow}_{i,t}}{
	\prod_{s=t_{0,i}+1}^{t}
	\left( 
	1 + r_{\mathrm{free}, s} + \alpha + \beta r_{\mathrm{market}, s}
	\right)
} 
\]
Here, the \cite{DLP12} approach relies on the identifying assumption that the model is correctly specified, so that $\mathbb{E}[NPV_i(\theta_0)] = 0$.

In this Methodology section, we will show:
\begin{enumerate}
	\item Why this estimator is unconditionally unbiased for pooled cash flows when we use this Net Present Value approach and analyze the bias term introduced by the Net Future Value approach (Section \ref{sec:asset_pricing_pooled}).
	\item How to modify the estimator to be able to control the bias term (Section \ref{sec:fundwise_lmd_estimator}).
	\item How we can estimate asymptotic standard errors for the parameters alpha and beta (Sections \ref{sec:asymptotic_framework} and \ref{sec:asymptotic_inference}).
	\item How our estimator compares to similar approaches (Section \ref{sec:comparison_to_similar_estimators}.)
\end{enumerate}

\begin{table}[ht]
	\centering
	\small
	\begin{tabular}{@{}ll@{}}
		\toprule
		Symbol & Description \\
		\midrule
		$n$ & Number of cross-sectional units (funds or portfolios) \\
		$V$ & Number of distinct vintage years \\
		$n_v$ & Number of portfolios in vintage year $v$ \\
		$v_i$ & Vintage year of fund/portfolio $i$ \\
		$J$ & Number of deals per fund \\
		$K_{i,j}$ & Number of divestment cash flows for deal $j$ of fund $i$ \\
		$CF_{i,t}$ & Net cash flow of fund $i$ at time $t$ \\
		$\Psi_t$\ , $M_t$ & Multi-period and single-period SDF \\
		$\Psi_{\tau,t}(\theta)$ & SDF ratio $\Psi_t / \Psi_\tau$, parameterized by $\theta$ \\
		$\theta = (\alpha, \beta)$ & SDF parameter vector (intercept and factor loadings) \\
		$\theta_0$ & True parameter vector \\
		$\delta_{i,j}$ & Deal-level pricing error \\
		$\epsilon_{\tau,i}$ & Fund pricing error at discounting date $\tau$ \\
		$\bar{\epsilon}_i$ & Weighted average pricing error of fund $i$ \\
		$a_i$ & Fund-level alpha (abnormal return; distinct from SDF $\alpha$) \\
		$\mathcal{T}_i$ & Set of discounting dates for fund $i$ \\
		$w_i$ & Weighting factor for fund $i$ \\
		$L(\cdot)$ & Loss function (e.g., $L(x) = x^2$) \\
		$Q_n(\theta)$ & Sample objective function \\
		$d_{i,j}$ & Economic distance between units $i$ and $j$ \\
		$D$ ($= b_n$) & SHAC bandwidth parameter \\
		$H$ & Hessian of population objective at $\theta_0$ \\
		$\Lambda$ & Long-run covariance matrix of the score \\
		$\Sigma$ & Asymptotic covariance matrix of $\hat{\theta}$ \\
		\bottomrule
	\end{tabular}
	\caption{Key notation for the Methodology section.}
	\label{tab:notation}
\end{table}

\subsection{Asset Pricing for Pooled Cash Flows}
\label{sec:asset_pricing_pooled}

Let private equity fund $i=1,2,\dots,n$ be characterized by its net cash flows ${CF}_{i,t}$ (i.e., distributions minus contributions) and its net asset values ${NAV}_{i,t}$ with discrete time index $t=0,1,2,\dots,T$.
To increase the mathematical tractability of the problem, we assume a  deal-by-deal data generating process (DGP) for $CF$ where each fund deal consists exactly of one investment and one divestment cash flow in combination with a simple return model for the multi-period deal returns.
This means the fund-level cash flow process $(CF_{i,t})_{t=0,1,...,T}$ is an aggregation of deal-level cash flow pairs consisting of one negative at deal inception and at least one positive cash flow later $CF_{i,t} = \sum_j^J {cf}_{j,i,t}$.
\begin{assume}
	\label{ass:deal_level_dgp}
	Deal-level data generation process: \\
	1. Each fund $i$ consists of $J$ underlying deals. \\
	2. Each deal is characterized by exactly one, negative investment cash flow, denoted by $\mathrm{Inv}_{i,j}$, which occurs at time $t_{i,j}^{\mathrm{Inv}} \in \{ 0,1,\dots, T-1 \}$. 
	It holds $\mathrm{Inv}_{i,j} < 0$. \\
	3. Each deal is characterized by a positive divestment cash flow stream, denoted by $(\mathrm{Div}_{i,j,k})_{k=1,\dots,K_{i,j}}$, which occur after the investment cash flow $t_{i,j,k}^{\mathrm{Div}} > t_{i,j}^{\mathrm{Inv}}$ for all $k$.
	It holds $\mathrm{Div}_{i,j,k} > 0$. \\
	4. The cumulative fund cash flows are generated by summarizing over all deal-level cash flows, i.e., 
	$\sum_{t=0}^T {CF}_{i,t} = \sum_{j=1}^J \left( \mathrm{Inv}_{i,j} + \sum_{k=1}^{K_{i,j}} \mathrm{Div}_{i,j,k} \right)$ for all $i$.
\end{assume}

From asset pricing theory, we know that we can use a stochastic discount factor $\Psi_t$ to price each underlying deal
\begin{equation}
	\label{eq:deal_pricing}
	\mathbb{E} \left[ 
	\delta_{i,j}
	\left| \mathcal{F}_{t_{i,j}^{\mathrm{Inv}}} \right.
	\right] = 0
	\quad \forall \ i,j
\end{equation}
where we denote the deal-level pricing error by
\begin{equation}
	\label{eq:deal_pricing_error}
	\delta_{i,j} :=
	\mathrm{Inv}_{i,j} +
	\sum_{k=1}^{K_{i,j}}
	\frac{\Psi_{t_{i,j,k}^{\mathrm{Div}}}}{\Psi_{t_{i,j}^{\mathrm{Inv}}}}
	\mathrm{Div}_{i,j,k}
\end{equation}

Before we can derive the expected value for the fund-level pricing errors, let us analyze the deal-level counterparts.


\paragraph{Case A: Discounting deals to a date before investment ($\tau < t_{i,j}^{\mathrm{Inv}}$)}

First we apply the Law of Iterated Expectations (the so-called ``tower property") to determine the fair value of individual deal cash flows at time $\tau < t_{i,j}^{\mathrm{Inv}}$.

\begin{equation}
	\mathbb{E} \left[ \frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_{\tau}} \delta_{i,j} \mid \mathcal{F}_{\tau} \right] 
	= 
	\mathbb{E} \left[ \mathbb{E} \left[ \frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_{\tau}} \delta_{i,j} \mid \mathcal{F}_{t_{i,j}^{\mathrm{Inv}}} \right] \mid \mathcal{F}_{\tau} \right]
\end{equation}

Since the term $\frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_{\tau}}$ is fully known at time $t_{i,j}^{\mathrm{Inv}}$, it can be pulled out of this inner expectation to receive

\begin{equation}
	\label{eq:zero_deal_expectation}
	\mathbb{E} \left[ \frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_{\tau}} \delta_{i,j} \mid \mathcal{F}_{\tau} \right] 
	= 
	\mathbb{E} \left[ \frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_{\tau}} \underbrace{\mathbb{E} \left[ \delta_{i,j} \mid \mathcal{F}_{t_{i,j}^{\mathrm{Inv}}} \right]}_{= 0 \text{ by Eq. \ref{eq:deal_pricing}}} \mid \mathcal{F}_{\tau} \right] 
	= 
	\mathbb{E} \left[ \frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_{\tau}} \cdot 0 \mid \mathcal{F}_{\tau} \right] 
	= 0
\end{equation}



\paragraph{Case B: Discounting deals to a date after investment ($\tau > t_{i,j}^{\mathrm{Inv}}$)}


When the discounting/compounding date $\tau$ is after the investment date, the term $\Psi_{t_{i,j}^{\mathrm{Inv}}} / \Psi_{\tau}$ is not known at $t_{i,j}^{\mathrm{Inv}}$ (it depends on future SDF realizations). Thus, the previous logic does not hold. Instead, we have a non-zero term that represents the accumulated realized pricing error.

Let $\tau > t_{i,j}^{\mathrm{Inv}}$. The expectation becomes:

\begin{equation}
	\mathbb{E} \left[ \frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_{\tau}} \delta_{i,j} \mid \mathcal{F}_{\tau} \right] 
	= 
	\frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_{\tau}} \mathbb{E} \left[ \delta_{i,j} \mid \mathcal{F}_{\tau} \right]
\end{equation}

Since we condition on $\mathcal{F}_{\tau}$ and $t_{i,j}^{\mathrm{Inv}} < \tau$, the SDF ratio is known and can be pulled out.
Then the term $\mathbb{E} \left[ \delta_{i,j} \mid \mathcal{F}_{\tau} \right]$ is the conditional expectation of the pricing error given information available at time $\tau$. It decomposes as:

\begin{equation}
	\label{eq:non_zero_deal_expectation}
	\mathbb{E} \left[ \delta_{i,j} \mid \mathcal{F}_{\tau} \right] 
	= 
	\underbrace{\mathrm{Inv}_{i,j} + \sum_{t_{i,j,k}^{\mathrm{Div}} \le \tau} \frac{\Psi_{t_{i,j,k}^{\mathrm{Div}}}}{\Psi_{t_{i,j}^{\mathrm{Inv}}}} \mathrm{Div}_{i,j,k}}_{\text{Realized Cash Flows}} 
	+ 
	\underbrace{\mathbb{E} \left[ \sum_{t_{i,j,k}^{\mathrm{Div}} > \tau} \frac{\Psi_{t_{i,j,k}^{\mathrm{Div}} }}{\Psi_{t_{i,j}^{\mathrm{Inv}}}} \mathrm{Div}_{i,j,k} \mid \mathcal{F}_{\tau} \right]}_{\text{Expected Future Cash Flows}}
\end{equation}

Generally, this sum can become (is usually) non-zero because it includes realized shocks (abnormal returns) that occurred between $t_{i,j}^{\mathrm{Inv}}$ and $\tau$.

\paragraph{Case C: Compounding deals to a future date}

Let us analyze the following Net Future Value (NFV) case, where $t_{i,j}^{\mathrm{Future}}$ denotes a compounding target date after the deal investment date (i.e., $\tau < t_{i,j}^{\mathrm{Inv}} < t_{i,j}^{\mathrm{Future}}$).

\begin{align}
	\label{eq:future_value_bias_derivation}
	\mathbb{E} \left[ \frac{\Psi_{t_{i,j}^{\mathrm{Future}}}}{\Psi_{\tau}} \delta_{i,j} \mid \mathcal{F}_{\tau} \right] \nonumber
	&= 
	\mathbb{E} \left[ 
	\frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_{\tau}} 
	\frac{\Psi_{t_{i,j}^{\mathrm{Future}}}}{\Psi_{t_{i,j}^{\mathrm{Inv}}}}
	\delta_{i,j} \mid \mathcal{F}_{\tau} \right] 
		\\ \nonumber
	&=	
	\mathbb{E} \left[ 
	\frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_{\tau}}
	\mathbb{E} \left[ \frac{\Psi_{t_{i,j}^{\mathrm{Future}}}}{\Psi_{t_{i,j}^{\mathrm{Inv}}}}  \delta_{i,j} \mid \mathcal{F}_{t_{i,j}^{\mathrm{Inv}}} \right] \mid \mathcal{F}_{\tau} \right]
		\\ \nonumber
	&=
	\mathbb{E} \left[ 
	\frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_{\tau}}
	\left(
	\mathrm{Cov} \left( \frac{\Psi_{t_{i,j}^{\mathrm{Future}}}}{\Psi_{t_{i,j}^{\mathrm{Inv}}}}, \delta_{i,j} \mid \mathcal{F}_{t_{i,j}^{\mathrm{Inv}}} \right)
	+ \mathbb{E} \left[ \frac{\Psi_{t_{i,j}^{\mathrm{Future}}}}{\Psi_{t_{i,j}^{\mathrm{Inv}}}} \mid \mathcal{F}_{t_{i,j}^{\mathrm{Inv}}} \right]
	\underbrace{\mathbb{E} \left[ \delta_{i,j} \mid \mathcal{F}_{t_{i,j}^{\mathrm{Inv}}} \right]}_{= 0 \text{ by Eq.~\ref{eq:deal_pricing}}}
	\right) \mid \mathcal{F}_{\tau} \right]
		\\
	&= 
	\mathbb{E} \left[ 
	\frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_{\tau}}
	\mathrm{Cov} \left( \frac{\Psi_{t_{i,j}^{\mathrm{Future}}}}{\Psi_{t_{i,j}^{\mathrm{Inv}}}}, \delta_{i,j} \mid \mathcal{F}_{t_{i,j}^{\mathrm{Inv}}} \right) \mid \mathcal{F}_{\tau} \right]
\end{align}

The term can generally become non-zero, representing the covariance between the deal's pricing error and the future level of the SDF, effectively a risk premium for the timing mismatch.

This result highlights a fundamental dichotomy. 
For \emph{ex-ante} asset pricing tests, the Net Future Value approach is misspecified: the non-zero conditional covariance implies that the conditional moment condition $\mathbb{E}[m^{\mathrm{NFV}}_{i,j}(\theta_0) \mid \mathcal{F}_{\tau}]=0$ is violated, leading to biased parameter estimates if not explicitly corrected for this risk premium.
Conversely, for \emph{ex-post} performance benchmarking, this compounding approach remains valuable. 
By compounding realized cash flows to a future date $T$, we facilitate an intuitive comparison of the fund's generated terminal wealth against a public benchmark, provided one acknowledges that the resulting \emph{alpha} implicitly includes the compensation for the timing risk identified above.
This entails that any \emph{alpha} measured via Net Future Values is mechanically a composite metric. 
Specifically, we can mathematically decompose the expected NFV pricing error into two distinct components:
\begin{align}
	\label{eq:alpha_decomp}
	\underbrace{\mathbb{E} \left[ \frac{\Psi_{t_{i,j}^{\mathrm{Future}}}}{\Psi_{\tau}} \delta_{i,j} \mid \mathcal{F}_{\tau} \right]}_{\text{Measured Alpha}} 
	&= 
	\underbrace{\mathbb{E} \left[ \frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_{\tau}} \frac{a_{i,j}^{\text{True}}}{R_{f, t_{i,j}^{\mathrm{Inv}} \to t_{i,j}^{\mathrm{Future}}}} \mid \mathcal{F}_{\tau} \right]}_{\text{True Skill}}
	\\ \nonumber
	&+ 
	\underbrace{\mathbb{E} \left[ \frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_{\tau}} \mathrm{Cov} \left( \frac{\Psi_{t_{i,j}^{\mathrm{Future}}}}{\Psi_{t_{i,j}^{\mathrm{Inv}}}}, \delta_{i,j} \mid \mathcal{F}_{t_{i,j}^{\mathrm{Inv}}} \right) \mid \mathcal{F}_{\tau} \right]}_{\text{Timing Risk Premium}}
\end{align}
where $R_f$ is the gross risk-free return over the holding period and $a^{\text{True}}$ is the deal's expected pricing error at inception (fund-level abnormal return, distinct from the SDF intercept $\alpha$).
Even if a manager has no skill ($a^{\text{True}} = 0$), the measured alpha will include the \emph{Timing Risk Premium} which is the (discounted) covariance between the future SDF realization and the deal valuation.
This is not a flaw but a feature of ex-post benchmarking: it correctly reflects that the investor was exposed to this specific path of SDF realizations.
However, for ex-ante pricing tests, the presence of this non-zero \emph{Timing Risk Premium} is problematic.
Standard econometric estimators are designed to find parameters that set the average pricing error to zero.
If the theoretical moment contains this positive premium, the estimator will be forced to compensate by biasing the estimated alpha downwards or distorting the SDF parameters to ``explain away'' the \emph{Timing Risk Premium}.






\paragraph{Fund-level pricing error}

For the pooled, fund-level cash flow stream, we assume that the true fund valuation $V_{i,\tau}$ is generally not observable for us
\begin{equation}
	\label{eq:fund_valuation}
	V_{i,\tau} :=
	\mathbb{E} \left[ 
	\sum_{t = \tau}^T
	\frac{\Psi_{t}}{\Psi_{\tau}}
	{CF}_{i,t}
	\left| \mathcal{F}_{\tau} \right.
	\right]
	\quad \forall \ \tau \geq \ \min_j t_{i,j}^{\mathrm{Inv}}
\end{equation}
For active funds with $\tau > \min_j t_{i,j}^{\mathrm{Inv}}$, we merely can observe reported fund NAVs as proxies for the true fund value, which are known to suffer from stale pricing and appraisal-smoothing problems \citep{BGK19,K19,JLRS20}\footnote{In the empirical section, we will treat the most recent NAV as the final distribution cash flow for non-liquidated funds to increase the sample data.}.
Additionally, we can define the vintage year for each fund in a mathematically convenient way as $v_{i} := \mathrm{YEAR} \left( \min_j t_{i,j}^{\mathrm{Inv}} \right)$.

For any discounting date $\tau \leq \min_j t_{i,j}^{\mathrm{Inv}}$, the expected fund pricing error is equal to zero.

\begin{proposition}
	\label{theo:inception_value}
	(Price of a pooled cash flow stream at fund inception) \\
	\begin{equation}
		\label{eq:price_pooled_cash_flows}
		\mathbb{E} \left[ 
		\sum_{t = \tau}^T
		\frac{\Psi_{t}}{\Psi_{\tau}}
		{CF}_{i,t}
		\left| \mathcal{F}_{\tau} \right.
		\right]
		= 0
	\end{equation}
	if $\tau \leq \ \min_j t_{i,j}^{\mathrm{Inv}}$.
\end{proposition}

\begin{proof}
	Let us first analyze the case  $\tau \leq \min_j t_{i,j}^{\mathrm{Inv}}$ by expressing the fund cash flows in term of discounted deal pricing errors using Equation \ref{eq:deal_pricing_error}.
		\begin{equation}
		\label{eq:price_pooled_cash_flows_proof_1}
		\mathbb{E} \left[ 
		\sum_{t = \tau}^T
		\frac{\Psi_{t}}{\Psi_{\tau}}
		{CF}_{i,t}
		\left| \mathcal{F}_{\tau} \right.
		\right]
		=
		\mathbb{E} \left[ 
		\sum_{j=1}^J
		\frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_{\tau}}
		\delta_{i,j}
		\left| \mathcal{F}_{\tau} \right.
		\right]
	\end{equation}
	Then we can simply plug in Equation \ref{eq:zero_deal_expectation} to receive the postulated zero expected fund pricing error.
	\begin{equation}
		\label{eq:price_pooled_cash_flows_proof_2}
		\mathbb{E} \left[ 
		\sum_{j=1}^J
		\frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_{\tau}}
		\delta_{i,j}
		\left| \mathcal{F}_{\tau} \right.
		\right]
		= 
		\mathbb{E} \left[ 
		\sum_{j=1}^J
		\frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_{\tau}}
		\cdot 0
		\left| \mathcal{F}_{\tau} \right.
		\right]
		= 0
	\end{equation}	
\end{proof}

Next, let us analyze the case $\tau > \min_j t_{i,j}^{\mathrm{Inv}}$ for Equation \ref{eq:fund_valuation}.
For any deal $j$ with $t_{i,j}^{\mathrm{Inv}} < \tau$, the conditional expectation $\mathbb{E}[\delta_{i,j} | \mathcal{F}_{\tau}]$ represents the realized abnormal return of the deal up to time $\tau$. 
For a generic risky asset, this realized return is a random variable with non-zero variance. 
Therefore, the condition that Equation \ref{eq:fund_valuation} equals 0 holds \emph{ex-post} only by chance (i.e., if realized shocks cancel out exactly). 
Ex-ante, without knowledge of realizations, $\tau \leq \min_j t_{i,j}^{\mathrm{Inv}}$ is the necessary condition to guarantee a zero expected pricing error.


\subsection{Least-Mean-Distance estimator}
\label{sec:fundwise_lmd_estimator}

In this subsection, we introduce a new SDF estimator designed to analyze the effect of different discounting dates $\tau$ on the bias and variance of the estimated SDF parameters.
In the previous subsection, we demonstrated that only the fund inception date yields unconditionally unbiased parameter estimates in a NPV-style optimization formulation.
However, to be able to empirically test the impact of mixing in biased NFV terms, we choose to generalize our estimation framework so we can handle both cases flexibly.
With this respect, our general idea is to rather average over multiple ``suitable" discounting date candidates $\tau$ than to select only one candidate for the ``unconditionally optimal" discounting date.

Henceforth, we assume that the underlying transactions within a private equity fund cannot be distinguished individually, and that only the fund’s total (pooled) cash flows are observable.
The stochastic discount factor $\Psi_{\tau,t}$ is used to calculate the time-$\tau$ ``price" $P_{\tau,t,i}$ of a \textbf{single} time-$t$ cash flow of any given PE fund $i$
\begin{equation}
\label{eq:price}
P_{\tau,t,i} := \Psi_{\tau,t} \cdot CF_{i,t}
= \frac{\Psi_{t}}{\Psi_{\tau}} \cdot CF_{i,t}
\qquad \forall \quad \tau,t,i
\end{equation}
with multi-period SDF $\Psi_t = \prod_{k=1}^t M_k$ and $M_0 = 1$.
As SDFs are commonly parameterized by a vector $\theta \in \mathbb{R}^{p}$, i.e., $\Psi_{\tau,t} \equiv \Psi_{\tau,t} (\theta)$, our goal is to find an estimation method for the optimal $\theta$.
We denote this optimal/best/true parameter vector as $\theta_0$.
We call the numerator $\Psi_{t}$ the discount part of the multi-period SDF $\Psi_{\tau,t}$ (used for present value calculations) and the denominator $\Psi_{\tau}$ the compound part (used for future value calculations).
For each fund $i$ and all points $\tau$ within a common fund lifetime, the empirical "pricing error" $\epsilon_{\tau,i}$ of \textbf{all} fund cash flows is calculated as time-$\tau$ ``present value"
\begin{equation}
\label{eq:pricing_error}
\epsilon_{\tau,i} := \sum_{t=0}^T P_{\tau,t,i} 
\qquad \forall \quad \tau,i
\end{equation}
We use the terms ``price", ``pricing error" and ``net present value" in quotation marks to acknowledge the theoretical asset pricing problem which can arise for pooled cash flows and has been described in the previous subsection.

To better analyze the impact of different discount date $\tau$ on the estimator's bias and variance, we define the ($w_i$-weighted) average pricing error $\bar{\epsilon}_{i}$ that averages over the set $\mathcal{T}_i$
\begin{equation}
\label{eq:average_pricing_error}
\bar{\epsilon}_{i} =
w_{i} \cdot
\frac{1}{ \mathrm{card}(\mathcal{T}_{i}) }
\sum_{\tau \in \mathcal{T}_{i}}
\epsilon_{\tau,i}
\qquad \forall \quad i
\end{equation}
where $\mathcal{T}_i$ gives the set of discounting dates $\tau$ for fund $i$ which is more thoroughly described below.
Finally, the scalar weighting factor $w_i$ can be (i) one divided by the fund's invested capital for equal weighting of funds, (ii) one divided by the vintage year sum of invested capital for vintage year weighting, (iii) the scalar one for fund-size weighting, or (iv) some macroeconomic deflator.

\paragraph{The role of $\mathcal{T}_i$}

The set $\mathcal{T}_i$ controls which discounting dates enter the 
averaged pricing error $\bar{\epsilon}_i$ in 
Equation~\ref{eq:average_pricing_error}, as visualized in 
Figure~\ref{fig:npvs}. The smallest choice 
$\mathcal{T}_i = \{\min_j t_{i,j}^{\mathrm{Inv}}\}$ corresponds to 
a classical NPV calculation and is used by both \cite{DLP12} and 
\cite{KN16}. The largest candidate set includes all periods from 
inception to the present.

Averaging over multiple dates in $\mathcal{T}_i$ was originally 
motivated by the ``exploding alpha'' problem first described by 
\cite{DLP12}: when the initial cash flow is very small, an 
arbitrarily large alpha can discount all subsequent cash flows close 
to zero, rendering the beta factors irrelevant and distorting 
estimation. Averaging over $\mathcal{T}_i$ mitigates this 
degeneracy.

However, as shown in Section~\ref{sec:asset_pricing_pooled}, 
including future value dates in $\mathcal{T}_i$ introduces a timing 
risk premium bias. The bias--variance tradeoff of different 
$|\mathcal{T}_i|$ choices is studied empirically in the simulation 
study (Section~\ref{sec:simulation_study}).

\begin{figure}[ht]
	\centering
	\includegraphics[width=0.9\textwidth]{Figures/spatial/npvs3.eps}
	\caption{
		How to calculate and interpret the average pricing error introduced by Equation \ref{eq:average_pricing_error}:
		The time index $t$ is relevant for the net cash flows (black dots).
		The time index $\tau$ is used for the pricing error, i.e., the sum of discounted net cash flows (blue boxes).
		The weighted average of these "pricing errors" gives the average pricing error $\bar{\epsilon}$ as defined in Equation \ref{eq:average_pricing_error} (solid blue line).
		In this example, $\mathrm{card}(\mathcal{T}_{i})=7$, i.e., the number of blue boxes.
	}
	\label{fig:npvs}
\end{figure}

\begin{assume}
	\label{ass:unconditional_unbiased}
	To guarantee an unconditionally unbiased estimator, we assume to always only discount to the fund start date $\mathcal{T}_i = \left\{
	\min_j t_{i,j}^{\mathrm{Inv}} \right\}$.
\end{assume}

\begin{remark}
	Assumption~\ref{ass:unconditional_unbiased} guarantees that $\mathbb{E}[\bar{\epsilon}_i(\theta_0)] = 0$ under the true parameter.
	For the quadratic loss $L(x) = x^2$, the population objective $Q_0(\theta) = -\mathbb{E}[\bar{\epsilon}_i(\theta)^2] = -\mathrm{Var}[\bar{\epsilon}_i(\theta)] - (\mathbb{E}[\bar{\epsilon}_i(\theta)])^2$ involves both variance and bias terms.
	Consistency then requires that $\theta_0$ uniquely minimizes this composite criterion (see Proposition~\ref{prop:consistency}).
\end{remark}

To find the optimal value for $\theta$, we select an estimator from the broad class of extremum estimators.
\begin{definition}
	\label{def:extremum_estimator}
	Extremum estimator \cite[Equation 1.1]{NM94}: \\
	An estimator $\hat{\theta}$ is an extremum estimator if there is an objective function $Q_n(\theta)$ such that
	\[
	\hat{\theta} = \arg\max_{\theta} \ Q_n(\theta)
	\]
	for $\theta \in \Theta$ where $\Theta$ is the set of all possible parameter values.
\end{definition}

Concretely, our Least Mean Distance (LMD) estimator \cite[Equation 7.1]{PP97} minimizes the average loss of $\bar{\epsilon}$.
For consistency with Definition \ref{def:extremum_estimator}, we will technically maximize the average negative loss of $\bar{\epsilon}$, which is equivalent.

\begin{equation}
\label{eq:estimator}
\hat{\theta} = 
\arg \max_{\theta \in \Theta}
\enspace
Q_n(\theta)
\quad
\mathrm{with}
\quad
Q_n(\theta) = -
\frac{1}{n}
\sum_{i=1}^n
L \left( \bar{\epsilon}_{i} \right) 
\end{equation}
where $L: \mathbb{R}^{1} \rightarrow \mathbb{R}^1$ denotes a loss function, e.g., $L(x)=(x-0)^2$ in the case of nonlinear least squares.
Throughout the paper, the weighted average fund pricing error $\bar{\epsilon}_i \equiv \bar{\epsilon}_i(\theta)$ is regarded as nonlinear random function of the SDF parameter $\theta$.



\subsection{Asymptotic framework}
\label{sec:asymptotic_framework}

By the value-additivity principle \citep{HR87}, our SDF model holds for any aggregation level of cash flows. 
In practice, we form vintage-year portfolios as cross-sectional units, which mitigates 
idiosyncratic noise and GP financial engineering artifacts while preserving sufficient test assets for parameter identification.

\begin{assume}
	\label{as:portfolio}
	For each vintage year, we pool fund cash flows to form $n_v$ portfolios. 
	Thus, $n = \sum_{v=1}^V n_v$. 
	The boundary cases are (i) single-fund portfolios and (ii) one portfolio per 
	vintage year.
	Both equal-weighed and fund-value-weighted portfolios are considered.
\end{assume}

Without loss of generality, we refer to cross-sectional units as funds. 
The detailed comparison of aggregation levels is provided in Section~\ref{sec:simulation_study}.

The pricing error $\bar{\epsilon}_{i}$ is naturally indexed by both fund identity and vintage year, yielding a random field $\bar{\epsilon}_{i} \equiv \bar{\epsilon}_{i,v_i}$ that fits neither standard time-series, cross-sectional, nor panel data frameworks (cf.\ Figure \ref{fig:randomfields}). 
We address this by adopting a spatial framework similar to \cite{KN16}, where they measure the economic distance between funds as a function of the cash flow overlap.
Thus, we generally consider $\bar{\epsilon}$ from Equation \ref{eq:average_pricing_error} as a random field (cf. Figure  \ref{fig:randomfields}).
In our case, it is convenient to interpret the fund vintage year $v_i$ as second dimension in our pricing error random field, i.e., $\bar{\epsilon}_{i} \equiv \bar{\epsilon}_{i, v_i}$.

Yet, in this section, we mainly follow the time-series asymptotic framework of \cite{PP97} since our ``spatial" distance measure (between vintage years) is time, and adaptation to our case is thus straightforward.
If we observe only one fund per vintage year (or, equivalently, form vintage year portfolios), we will easily see that the framework of \cite{PP97} with time-series indexing can be applied without any major modification.


\subsubsection{Vintage year asymptotics}

\begin{figure}[ht]
	\centering
	\includegraphics[width=0.9\textwidth]{Figures/spatial/randomfields.pdf}
	\caption{
		Visualization of generic random field types.
		Each black dot marks a different observation $i$ of the cash flow data.
		Importantly, the time axis does \textbf{not} correspond to the index $t$ in $CF_{i,t}$ (rather to vintage years $v_i$).
		Comparing the four choices, we want to avoid an infill random field but prefer our data to constitute an increasing domain random field.
		The infill random field is even asymptotically ``too clustered" or better ``too unrepresentative" to allow for meaningful estimation and inference.
		The time-series and cross-sectional random fields correspond to the standard cases in the literature but could turn out too restrictive for a general approach.
		By smart design (like portfolio formation), we often can map an increasing domain random field to simpler time-series or cross-sectional versions.
	}
	\label{fig:randomfields}
\end{figure}

We assume that the ``spatial" (i.e., economic) distance between cross-sectional units, i.e., private equity funds/portfolios, can be measured quantitatively\footnote{Generally, the economic distance measure could include multiple dimensions, e.g., temporal, geographic, and industry sector proximity. This could be an interesting topic for future research.}.
Our ``cross-sectional" asymptotic theory lets the number of funds go to infinity $n \to \infty$.
% However, empirical identification of model parameters requires a sufficient number of funds from different vintage years in the fund-level data set used for model estimation, as emphasized by \cite{DLP12} and \cite{KN16}.
To expose our SDF to many distinct covariate realizations (economic conditions), we also want the number of vintages to increase asymptotically.
\begin{assume}
	\label{as:vya}
	Vintage year asymptotics:
	\begin{enumerate}
		\item The number of vintage years $V \to \infty$ as $n \to \infty$.
		\item The number of funds per vintage year is bounded by some positive constant.\footnote{This assumption is naturally satisfied when forming vintage-year portfolios (case (ii) of Assumption \ref{as:portfolio}, with $n_v = 1$).
			For the individual fund case (i), it ensures that the SHAC estimator remains consistent and that standard errors scale with the number of vintage years rather than the total fund count. 
			Relaxing this assumption would require cluster-robust inference at the vintage-year level.
		}
		\item The maximum fund lifetime is also bounded by a positive constant.
		\item The economic distance between fund $i$ and $j$ is measured by the vintage year difference $d_{i,j} = | v_i - v_j | +  \rho_0 \mathbf{1}_{i \neq j}$ with minimum distance $\rho_0 > 0$.
		Note that two distinct funds from the same vintage year have distance $d_{i,j} = \rho_0$, reflecting our assumption that within-vintage-year dependence is captured by the SHAC kernel at the smallest lag.
	\end{enumerate}
\end{assume}
In terms of the spatial estimation literature, this assumption postulates increasing domain asymptotics and rules out so-called infill asymptotics (cf.\ Figure \ref{fig:randomfields}).
The minimum distance term $\rho_0$ is a means to ensure these increasing domain asymptotics \cite[Assumption 1]{JP12}.
Infill asymptotics corresponds to the approach of \cite{DLP12}, who fix the number of portfolios $N$ and let the number of underlying funds per portfolio $n_i \to \infty$.
While this yields consistency for a given set of portfolios, it fundamentally conditions on the observed macro environment: with fixed $N$, no new vintage years—and hence no new factor realizations—enter the estimation. 
In contrast, our increasing domain framework ($V \to \infty$) permits inference that accounts for cross-vintage variation in economic conditions, which is necessary for the unconditional identification of SDF parameters (see Section \ref{sec:asset_pricing_pooled}).
Finally, a further advantage of the \emph{nonlinear least squares} formulation in Equation \ref{eq:estimator} is that it avoids the well-known complications arising when the number of GMM moment conditions grows with sample size \citep{HP06,NW09}.


\subsubsection{Law of large numbers}

Under Assumption \ref{ass:unconditional_unbiased} (NPV-only discounting), Proposition \ref{theo:inception_value} guarantees $\mathbb{E}[\bar{\epsilon}_i(\theta_0)] = 0$. 
For the general case where $\mathcal{T}_i$ includes future value dates, a residual bias may persist (see Section \ref{sec:asset_pricing_pooled}). 
In both cases, the LLN ensures that the sample objective $Q_n(\theta)$ converges uniformly to its population counterpart.
To approach this expected value in $\mathbb{E}[\bar{\epsilon}_i(\theta_0)]$, we rely on a spatial law of large numbers instead of applying a time-series law of large numbers.
Here, we want to explicitly acknowledge the statistical dependence of pricing errors from adjacent vintage years.

\begin{assume}
	\label{as:lln}
	Primitive conditions for uniform convergence \citep[cf.][Theorem 6]{JP09}: \\
	\begin{enumerate}
		\item \emph{Near-epoch dependence (NED):} For each $\theta \in \Theta$, the random field $\{L(\bar{\epsilon}_i(\theta))\}_{i=1,\ldots,n}$ is NED of size $-a$ (with $a > 0$) on an $\alpha$-mixing random field $\{\eta_v\}_{v \geq 1}$ indexed by vintage years, i.e.,
		$\left\| L(\bar{\epsilon}_i(\theta)) - \mathbb{E}\!\left[ L(\bar{\epsilon}_i(\theta)) \mid \sigma\!\left(\eta_v : |v - v_i| \leq m \right) \right] \right\|_p \leq c_i \cdot \nu(m)$
		with $\sup_i c_i < \infty$ and $\nu(m) = O(m^{-a})$.
		\item \emph{Mixing decay:} The base random field $\{\eta_v\}$ is $\alpha$-mixing with mixing coefficients $\alpha(d) = O(d^{-\gamma})$ for some $\gamma > 2(p-1)/(p-2)$ where $p > 2$.
		\item \emph{Moment conditions:} $\sup_{\theta \in \Theta} \mathbb{E}\!\left[\left| L(\bar{\epsilon}_i(\theta)) \right|^p \right] < \infty$ for some $p > 2$, uniformly in $i$.
		\item \emph{Stochastic equicontinuity:} The family $\{L(\bar{\epsilon}_i(\cdot)): i = 1,\ldots,n\}$ is stochastically equicontinuous in $\theta$, which is satisfied if $L$ is Lipschitz and $\bar{\epsilon}_i(\theta)$ is Lipschitz in $\theta$ uniformly in $i$.
	\end{enumerate}
\end{assume}

Under Assumptions~\ref{as:portfolio}--\ref{as:lln}, the ULLN $\sup_{\theta \in \Theta} |Q_n(\theta) - \mathbb{E}[Q_n(\theta)]| \xrightarrow{p.} 0$ follows from \cite[Theorem~6]{JP09}.
Economically, the NED condition means that the pricing error of a fund in vintage $v$ can be well-approximated using only information from nearby vintages $\{v - m, \ldots, v + m\}$, with approximation quality improving in $m$, which is natural since cash flow overlap decays with vintage year distance (cf.\ Assumption~\ref{as:vya}).
In practice, we treat funds with distance $d_{i,j} > D$ as approximately independent for the purpose of covariance estimation (cf.\ the bandwidth parameter $b_n = D$ in Section \ref{sec:asymptotic_inference}).
Since nominal fund sizes tend to grow over time, unweighted pricing errors $\bar{\epsilon}_i$ may be non-stationary; the weighting factor $w_i$ from Equation~\ref{eq:average_pricing_error} (e.g., scaled by invested capital) normalizes the pricing errors so that the moment condition (3) is satisfied.


\subsubsection{Consistency}

The estimator $\hat{\theta}$ shall converge in probability to the true parameter value $\theta_0$ as the number of distinct vintage years goes to infinity.

\begin{assume}
	\label{as:identification}
	(Identification) The population objective $Q_0(\theta)$ has a unique maximizer at $\theta_0$, i.e., $Q_0(\theta) < Q_0(\theta_0)$ for all $\theta \neq \theta_0$.
\end{assume}

\begin{remark}
	For $L(x)=x^2$, this requires that no alternative parameter vector $\theta \neq \theta_0$ can simultaneously achieve zero bias ($\mathbb{E}[\bar{\epsilon}(\theta)]=0$) and equal variance ($\mathrm{Var}[\bar{\epsilon}(\theta)] = \mathrm{Var}[\bar{\epsilon}(\theta_0)]$). 
	This is economically natural: mis-specifying the SDF factor loadings introduces systematic pricing errors whose variance exceeds the irreducible noise at $\theta_0$. 
	The condition is analogous to the standard rank condition in linear GMM.
\end{remark}


\begin{proposition}[Consistency]
	\label{prop:consistency}
	Under Assumptions \ref{as:portfolio}--\ref{as:identification}, 
	$\hat{\theta} \xrightarrow{p} \theta_0$ as $n \to \infty$.
\end{proposition}

\begin{proof}
	We verify the four conditions of \cite[Theorem~2.1]{NM94} for the 
	extremum estimator $\hat{\theta} = \arg\max_{\theta \in \Theta} 
	Q_n(\theta)$ with population objective 
	$Q_0(\theta) := \mathbb{E}[Q_n(\theta)] 
	= -\mathbb{E}\bigl[L\bigl(\bar{\epsilon}_i(\theta)\bigr)\bigr]$.
	
	\begin{enumerate}
		\item \textit{Identification.}
		Since $L \geq 0$, we have $Q_0(\theta) \leq 0$ for all $\theta$. 
		For the case $L(x) = x^2$,
		\[
		Q_0(\theta) 
		= -\mathrm{Var}\bigl[\bar{\epsilon}(\theta)\bigr] 
		- \bigl(\mathbb{E}[\bar{\epsilon}(\theta)]\bigr)^2.
		\]
		Under Assumption~\ref{ass:unconditional_unbiased}, Proposition~\ref{theo:inception_value} yields 	$\mathbb{E}[\bar{\epsilon}(\theta_0)] = 0$, so the bias term vanishes at $\theta_0$. For any $\theta \neq \theta_0$, at least one of (a) the bias term 
		$(\mathbb{E}[\bar{\epsilon}(\theta)])^2 > 0$ or (b) the variance term $\mathrm{Var}[\bar{\epsilon}(\theta)] > \mathrm{Var}[\bar{\epsilon}(\theta_0)]$ must hold, ensuring $Q_0(\theta) < Q_0(\theta_0)$. 
		This is the standard identification condition requiring that the true parameter is the unique minimizer of the expected loss.
		
		\item \textit{Compactness.}
		The parameter space $\Theta$ is compact by economic reasoning: factor loadings and intercepts are bounded by plausible ranges implied by the risk--return tradeoff.
		
		\item \textit{Continuity.}
		Continuity of $Q_0(\theta)$ follows from the continuous dependence of $\Psi_{\tau,t}(\theta)$ on $\theta$ and the dominated convergence theorem, which is a standard regularity condition.
		
		\item \textit{Uniform convergence.}
		By Assumption~\ref{as:lln}, $\sup_{\theta \in \Theta} |Q_n(\theta) - Q_0(\theta)| 
		\xrightarrow{p} 0$, which directly satisfies the ULLN requirement of \cite[Section~2.1]{NM94}.
	\end{enumerate}
\end{proof}




\subsubsection{Central limit theorem}

To assess the large-sample significance of our parameter estimates in Subsection \ref{sec:asymptotic_inference}, we establish the asymptotic distribution of $\hat{\theta}$.

\begin{proposition}[Asymptotic Normality]
	\label{prop:clt}
	Under the conditions of Proposition~\ref{prop:consistency}, suppose additionally that (i) $\theta_0$ is interior to $\Theta$, (ii) $Q_0(\theta)$ is twice continuously differentiable at $\theta_0$ with nonsingular Hessian $H := \nabla_{\theta\theta} Q_0(\theta_0)$, and (iii) a spatial CLT holds for the score. 
	Then
	\[
	\sqrt{n}(\hat{\theta} - \theta_0) 
	\overset{d}{\to} \mathcal{N}(0, \Sigma)
	\quad \text{as } n \to \infty,
	\]
	with sandwich covariance matrix 
	$\Sigma = H^{-1} \Lambda\, H^{-1}$, where $\Lambda := \lim_{n \to \infty} 
	n \cdot \mathrm{Var}\bigl[\nabla_\theta Q_n(\theta_0)\bigr]$ 
	is the long-run covariance matrix of the score.
\end{proposition}

\begin{proof}
	The result follows from the general asymptotic normality theorem for extremum estimators \cite[Theorem~3.1]{NM94}. 
	The key non-standard ingredient is condition~(iii): a CLT for the spatially dependent score $\nabla_\theta Q_n(\theta_0)$. Under the spatial near-epoch dependence structure posited in Assumption~\ref{as:lln} and the vintage year asymptotics of Assumption \ref{as:vya}, this follows from \cite[Theorem~4]{JP12}, which extends the \cite{PP97} framework to spatial random fields. 
	The remaining conditions of \cite[Theorem 3.1]{NM94}, i.e., interior $\theta_0$, smooth $Q_0$, and stochastic equicontinuity of the score, are standard regularity conditions satisfied by the continuous dependence of $\Psi_{\tau,t}(\theta)$ on~$\theta$.
\end{proof}

\begin{remark}
	The spatial CLT of \cite[Theorem~4]{JP12} requires the same NED and mixing conditions as Assumption~\ref{as:lln}, supplemented by a Lindeberg-type condition on the score contributions $\nabla_\theta L(\bar{\epsilon}_i)$.
	The Lindeberg condition is implied by the uniform moment bound in Assumption~\ref{as:lln}(3) applied to the score.
\end{remark}


\subsection{Large sample inference}
\label{sec:asymptotic_inference}

From Proposition \ref{prop:clt}, the asymptotic covariance matrix takes the sandwich form $\Sigma = H^{-1}\Lambda\, H^{-1}$\footnote{Since $H$ is the Hessian of a scalar objective, it is symmetric, so $H^{-1} = (H^{-1})^\top$.} with $H$ and $\Lambda$ as defined therein. 
We now describe how to construct consistent estimators $\hat{H}$ and $\hat{\Lambda}$.

We define the corresponding finite sample estimators analogously to \citet[Chapters 12, 13.1]{PP97}, and numerically approximate the first and second partial derivatives by finite differences\footnote{As an alternative to finite differences the widespread Broyden-Fletcher-Goldfarb-Shanno (BFGS) algorithm can be applied to approximate the Hessian \cite[Section 6.1]{NW06}.}.
Specifically, we use the following central difference approximations (with "small" $\delta$) \cite[Algorithm 2]{E17}:
% https://espace.curtin.edu.au/bitstream/handle/20.500.11937/70491/Eu%20C%202017.pdf?sequence=1&isAllowed=y
\[
f_{x}(x,y) \approx \frac{f(x+\delta,y) - f(x-\delta,y)}{2\delta}
\]
\[
f_{xx}(x,y) \approx \frac{f(x+\delta,y) + f(x-\delta,y) - 2  f(x,y)}{\delta^2}
\]
\[
f_{xy}(x,y) \approx \frac{f(x+\delta,y+\delta) + f(x-\delta,y-\delta) -  f(x+\delta,y-\delta) - f(x-\delta,y+\delta)}{4\delta^2}
\]
The Hessian term $\hat{H}$ is relatively straightforward
\[
\hat{H} = - \frac{1}{n} \sum_{i=1}^n \nabla_{\theta \theta} L \left( \bar{\epsilon}_i \right)
\]
The consistency $\hat{H} \xrightarrow{p} H$ is implied by the ULLN (Assumption~\ref{as:lln}) applied to the second derivatives.
Due to the spatial near-epoch dependence, the involved and computationally expensive part is to consistently estimate $\hat{\Lambda}$ by a Spatial Heteroskedasticity and Autocorrelation Consistent (SHAC) covariance matrix estimator \cite[Equation 2]{KS11}
\begin{equation}
\label{eq:hac}
\hat{\Lambda} = \frac{1}{n} \sum_{i=1}^n \sum_{j=1}^n
k_{i,j}
\left[
\nabla_{\theta} L \left( \bar{\epsilon}_i \right)
\left(
\nabla_{\theta} L \left( \bar{\epsilon}_j \right)
\right)^\top
\right]
\end{equation}
Since $\nabla_\theta Q_n(\theta) = -\frac{1}{n}\sum_i \nabla_\theta L(\bar{\epsilon}_i)$, the score contributions are $s_i(\theta) := \nabla_\theta L(\bar{\epsilon}_i)$, and $\hat{\Lambda}$ equivalently estimates $n \cdot \mathrm{Var}[\nabla_\theta Q_n]$.

We define the kernel weight $k$ as
\[
k_{i,j} \equiv K \left( \frac{d_{i,j}}{b_n} \right)
\]
with kernel function $K: \mathbb{R} \to [0,1]$ that satisfies $K(0)=1$, $K(x)=K(-x)$, $\int_{-\infty}^{\infty} K^2(x) dx < \infty$, and $K(\cdot)$ continuous at zero and at all but a finite number of other points.
A common choice is the Bartlett kernel $K_{BT}(x)= \max(0, 1-|x|)$; see equation 2.7 in \cite{A91} for other popular kernel choices.
This means absolute vintage year differences larger than the bandwidth (or truncation) parameter $b_n=D$ are considered independent and are thus excluded from the $\hat{\Lambda}$ estimation formula.

In large samples, the vector of parameter standard errors can thus be estimated by
\begin{equation}
	\label{eq:asy_se}
	\mathrm{SE}(\hat{\theta}) = 
	\sqrt{
		\mathrm{diag} \left[
		n^{-\frac{1}{2}}
		\hat{H}^{-1} \hat{\Lambda}\, \hat{H}^{-1}
		(n^{-\frac{1}{2}})^\top
		\right] 
	}
	=
	\sqrt{
		\mathrm{diag} \left[
		\hat{H}^{-1} \hat{\Lambda}\, \hat{H}^{-1}
		\right] 
		\cdot \frac{1}{n}
	}
\end{equation}
The Wald test statistic for linear hypotheses $\mathcal{H}_0: R \theta = r$ and $\mathcal{H}_1: R \theta \neq r$ is constructed as (where $\mathcal{H}_0$ and $\mathcal{H}_1$ are hypotheses and not Hessian terms $H$)
\[
W = 
(R \hat{\theta} - r)^\top
\left[
R
\frac{\hat{H}^{-1} \hat{\Lambda}\, \hat{H}^{-1}}{n}
R^\top
\right]^{-1}
(R \hat{\theta} - r)
\stackrel{H_0}{\sim}
\chi_q^2
\]
where $\hat{\theta}$ is the $p \times 1$ parameter vector, $R$ is a $q \times p$ matrix, and $r$ is a $q \times 1$ vector.
Usually, we select $R$ as $p \times p$ identity matrix, and $r$ as $p \times 1$ vector (e.g., of zeros).
Under the null hypothesis, $W$ is chi-squared distributed with $q$ degrees of freedom. As large values of $W$ indicate the rejection of $H_0$, the corresponding p-value is calculated as $1 - F_{\chi_q^2}(W)$ where $F_{\chi_q^2}$ is the cumulative distribution function of a chi-squared random variable with $q$ degrees of freedom.

However, given the limited amount of available private equity data (typically the oldest vintages start in the 1980s), asymptotic characterizations of ${\Sigma}$ and $\mathrm{SE}(\hat{\theta})$ are of limited importance. 
In empirical applications, the small sample behavior of an estimation method for private equity data is more relevant than its asymptotic theory.
Moreover, the standard asymptotic distribution associated with an estimator is generally not valid for post-model-selection inference, i.e., if a model selection procedure is applied to find the best model from a collection of competitors \citep{LP05}.





\subsection{Comparison to similar estimators}
\label{sec:comparison_to_similar_estimators}

Our Least-Mean-Distance (LMD) estimator introduced in Section \ref{sec:fundwise_lmd_estimator} belongs to the class of semiparametric nonlinear M-estimators as defined in \cite{PP97} which are extremum estimators.
To gain more flexibility and avoid unneeded complexity, we intentionally opt against the most prominent semiparametric nonlinear M-estimator framework, i.e., classical time-series Generalized Method of Moments (GMM) \citep{H82,H12}.
A classical GMM approach requires the construction of stationary, ergodic time-series of moment conditions that are used to empirically estimate the expected value of pricing errors in Equation \ref{eq:pricing_error}.
The stationarity requirement of classical time-series GMM limits (i) more elaborate weighting schemes for $w$, like fund-size weighting, and (ii) the usage of fund cash flows from non-realized vintages.

\subsubsection{Comparison to \cite{DLP12}}

The \cite{DLP12} approach is most closely related to our methodology.
One important difference is that we select a simpler and more flexible LMD estimator instead of a cross-sectional GMM approach.
In our view, the choice of the more complex cross-sectional GMM just introduces conceptual complexity without changing the estimating equations since the underlying formulas are basically the same as for our LMD estimator\footnote{The formulas are this similar because \cite{DLP12} use the identity matrix as GMM weighting matrix and skip the second GMM step.}.

As a first limitation, they have to regard vintage-year portfolios as their cross-sectional units; we can also use individual funds.
In this context, \cite{DLP12} state that ``to identify $\beta$, it is essential that the different FoFs are exposed to different market returns." 
We note that their estimator is valid as a cross-sectional approach: 
identification requires only that the cross-section of funds provides sufficient variation in factor exposure at a given market return realization\footnote{In a classic cross-sectional regression, we only have one market return realization.}. 
That said, having FoFs exposed to different market environments (i.e., different vintage years) does improve statistical power and is the basis for our increasing domain asymptotics.

Second, the \cite{DLP12} asymptotic theory is based on infill asymptotics: 
they fix the number of vintage year portfolios $n$ and let the number of underlying funds per portfolio $n_i \to \infty$. 
As discussed in Section~\ref{sec:asymptotic_framework}, this conditions inference on the observed macro environment since no new vintage years enter the estimation. Moreover, since each portfolio constitutes a moment condition from the GMM perspective, standard GMM theory requires $n$ to remain fixed \citep{HP06,NW09}. 
In contrast, our increasing domain framework lets the number of vintage years $V \to \infty$ while bounding the number of funds per vintage, enabling inference that reflects cross-vintage variation in economic conditions.

Further, \cite{DLP12} discount all fund cash flows exclusively to the fund inception date, corresponding to $\mathcal{T}_i = \{\min_j t_{i,j}^{\mathrm{Inv}}\}$ in our notation.
Under Assumption \ref{ass:unconditional_unbiased}, this is also the only choice that yields unconditionally unbiased estimates. 
Our framework generalizes this by allowing $\mathcal{T}_i$ to contain additional discounting dates, which we use to empirically study the bias--variance tradeoff analyzed in Section \ref{sec:asset_pricing_pooled}.
Although \cite{DLP12} describe their estimator as a one-step GMM approach, it can be viewed as a special case of our LMD estimator.
Specifically, Equation \ref{eq:estimator} from our methodology is a generalization of equation 3 from their paper.
Formally, setting $\mathcal{T}_i = \{\min_j t_{i,j}^{\mathrm{Inv}}\}$, $w_i = 1$, and $L(x) = x^2$ in Equation~\ref{eq:estimator} recovers their objective (Equation~\ref{eq:dlp12_minimization}).
Consequently, if someone accepts the assumptions from Subsection \ref{sec:asymptotic_framework}, our large sample inference framework from Subsection \ref{sec:asymptotic_inference} applies to their case without any significant modification.
Finally, \cite{DLP12} apply simple cross-sectional bootstrapping to obtain standard errors; in contrast, in Subsection \ref{sec:model_selection}, we use a cross-validation technique that is adapted to the near-epoch dependence of the PE fund data.

\subsubsection{Comparison to \cite{KN16}}

\cite{KN16} were the first to employ a spatial framework for asymptotic inference on private equity fund data. 
They measure the economic distance between funds by the degree of cash flow overlap 
and use the spatial HAC estimator of \cite{C99} to construct robust standard errors. 
Our spatial HAC framework similarly accounts for cross-vintage dependence but draws on the near-epoch dependent theory of \cite{PP97,KS11,JP12}. 
A key methodological difference is that \cite{KN16} estimate the SDF on synthetic public market portfolios using a time-series GMM estimator and then apply the resulting model to evaluate PE cash flows, whereas we estimate the SDF directly from PE fund cash flows.
\cite{KN16} choose this procedure since ``tests that use the ex post equity premium as a performance benchmark should be more powerful than tests that use the ex ante equity premium."
Specifically, we obtain the estimator of \cite[Equation 18]{KN16} in our framework if we replace $Q_n(\theta)$ in Equation \ref{eq:estimator} by Equation \ref{eq:kn16_estimator}.
\begin{equation}
\label{eq:kn16_estimator}
Q_n(\theta) = 
L \left(
\frac{1}{n}
\sum_{i=1}^n
\bar{\epsilon}_{i} 
\right)
\quad
\mathrm{with}
\quad
L(x) = x^{\top} W x = x^{\top} I x
\end{equation}
with identity matrix $I$ as weighting matrix $W$.
Note that since $L(x) = x^\top W x \geq 0$, maximizing $-L(\cdot)$ is equivalent to minimizing $L(\cdot)$; we omit the negative sign in Equation \ref{eq:kn16_estimator} for notational simplicity; accordingly, Equation~\ref{eq:kn16_estimator} is to be minimized with respect to $\theta$.
In accordance with classical GMM, the function $\frac{1}{n} \sum_{i=1}^n \bar{\epsilon}_{i}: \mathbb{R}^{n \times T} \times \Theta \to \mathbb{R}^m$ should be perceived as multidimensional where the dimensionality of the function output corresponds to the number of moment conditions.
In contrast to our scalar LMD setting ($\bar{\epsilon}_i \in \mathbb{R}$), here $\frac{1}{n}\sum_{i} \bar{\epsilon}_i \in \mathbb{R}^m$ may be multidimensional and $L(x) = x^\top W x$ is the standard quadratic GMM objective.

Time-series GMM estimators inherently bear the risk of under-identification if the corresponding time-series is constructed by pooling all fund cash flows from a given fund type.
When PE fund cash flows are pooled into a single moment condition as in Equation~\ref{eq:kn16_estimator} with $m=1$, the resulting estimator has just one moment condition, which is insufficient to identify multi-parameter models\footnote{In contrast, our estimator corresponds to the opposite edge case with asymptotically an infinite number of LMD ''moment conditions" (units to price) as we let $n \to \infty$.}.
Note that \cite{KN16} avoid this issue by estimating the SDF from public market data rather than PE cash flows; the under-identification concern arises only if one applies their framework directly to PE data, as we do in our estimator.
To counter under-identification, additional characteristic-based fund portfolios could be formed to increase the number of moment conditions per fund type; also, random portfolios combined with bootstrapping could make sense.
Yet, \cite{KN16} take another approach and introduce the concept of Generalized Public Market Equivalent (GPME), which elegantly avoids the under-identification issue.
Firstly, a public market SDF model is estimated by pricing public trading strategies that shall replicate PE funds instead of directly pricing the observed PE fund cash flows.
Only in a second step are these models applied to evaluate private equity fund cash flows.

In summary, our LMD estimator generalizes \cite{DLP12} by (a) permitting flexible discounting dates via $\mathcal{T}_i$, (b) employing increasing domain rather than infill asymptotics, and (c) providing SHAC-based inference. 
Relative to \cite{KN16}, we directly price PE cash flows rather than pricing public replicating strategies, which avoids potential misspecification of the public SDF but requires stronger identification assumptions from the PE data alone.
Table \ref{tab:comparison} summarizes the most prominent distinctions between the three approaches.

\begin{table}[ht]
	\centering
	\footnotesize
	\begin{tabular}{@{}l p{3.2cm} p{3.2cm} p{3.5cm}@{}}
		\toprule
		& \cite{DLP12} & \cite{KN16} & Our approach \\
		\midrule
		\textbf{Estimator type}
		& Cross-sectional NLS (one-step GMM) 
		& Time-series GMM (public SDF) 
		& Nonlinear Least-Mean-Distance \\
		\addlinespace
		\textbf{Cash flows priced}
		& PE fund cash flows 
		& Public replicating strategies 
		& PE fund cash flows \\
		\addlinespace
		\textbf{Discounting dates}
		& Fund inception only 
		& Fund inception only 
		& Flexible via $\mathcal{T}_i$ \\
		\addlinespace
		\textbf{Asymptotics}
		& Infill ($n_i \to \infty$, $N$ fixed) 
		& $V \to \infty$ 
		& Increasing domain ($V \to \infty$, $n_v$ bounded) \\
		\addlinespace
		\textbf{Inference}
		& Bootstrap 
		& Spatial HAC 
		& Spatial HAC \\
		\addlinespace
		\textbf{Cross-sectional unit}
		& Vintage year portfolio 
		& Single fund 
		& Both (tested empirically) \\
		\addlinespace
		\textbf{SDF specification}
		& Linear factor model 
		& Exponentially affine 
		& Both (tested empirically) \\
		\bottomrule
	\end{tabular}
	\caption{Comparison of SDF estimation frameworks for private equity.}
	\label{tab:comparison}
\end{table}


% Whole section: Work in progress!
\section{Empirical application}
\label{sec:empirical_application}

\subsection{Data}

We use the Preqin cash flow data set as of 14th April 2022 that is well known in the academic private equity literature \citep{HJK14,KN16,ACGP18}.
To keep the empirical analysis clear and concise, we filter the dataset for Private Equity (PE) funds.

The Private Equity sample contains 2745 distinct funds spreading over 35 vintage years. "The vintage year distribution is as follows: 1983 (1), 1985 (2), 1986 (4), 1987 (5), 1988 (7), 1990 (2), 1991 (4), 1992 (9), 1993 (13), 1994 (20), 1995 (16), 1996 (20), 1997 (24), 1998 (59), 1999 (46), 2000 (72), 2001 (51), 2002 (41), 2003 (45), 2004 (64), 2005 (117), 2006 (154), 2007 (176), 2008 (183), 2009 (83), 2010 (92), 2011 (146), 2012 (136), 2013 (142), 2014 (182), 2015 (152), 2016 (186), 2017 (143), 2018 (157), 2019 (190).
The region distribution is as follows: Africa (20), Asia (150), Australasia (39), Europe (681), Latin America \& Caribbean (33), Middle East (14), North America (1807).
The strategy distribution is as follows: Balanced (69), Buyout (1354), Co-Investment (87), Co-Investment Multi-Manager (59), Direct Secondaries (30), Fund of Funds (643), Growth (331), Secondaries (152), Turnaround (19).

For this subset of Private Equity funds, we extract all (i) equal-weighted and (ii) fund-size-weighted cash flow series.
For non-liquidated funds, we treat the latest net asset value as final cash flow.
We explicitly refrain from excluding the most recent vintage years.
Thus, the minimum vintage year is 1983 (just for PE), and the maximum is 2019 since we filtered out funds with younger vintage.

The public market factors that enter our SDF draw on the US data set of the recently popularized $q^5$ investment factor model sourced from \url{http://global-q.org/factors.html} \citep{HXZ15,HXZ20}. 
Their five-factor model includes the market excess return (MKT), a size factor (ME), an investment factor (IA), a return on equity factor (ROE), and an expected growth factor (EG).



\subsection{Model and estimator specifications}
\label{sec:model_selection}

We test a simple linear SDF model similar to \cite{DLP12}
\begin{equation}
\label{eq:linear_sdf}
\Psi_{\tau,t}^{\mathrm{SL}} (\theta) = 
\frac{\prod_{h=0}^{\tau}\ \left(1 + \alpha + r_{h} + \sum_j\ \beta_j \ F_{j,h} \right)}{\prod_{h=0}^{t}\ \left(1 + \alpha + r_{h} + \sum_j\ \beta_j\ F_{j,h} \right)}
\end{equation}
and an exponential affine SDF model adapted from \cite{KN16}
\begin{equation}
\label{eq:expaff_SDF}
\Psi_{\tau,t}^{\mathrm{EA}} (\theta) = 
\exp
\left[
\sum_{h=0}^{\tau} X_h
\sum_{h=0}^{t} - X_h
\right]
\end{equation}
with
\[
X_h = \alpha + \log (1 + r_h) + \sum_{j \in J} \beta_{j} \cdot \log (1 + F_{j,h})
\]
with (arithmetic) risk-free return $r=R_{rf}-1$, (arithmetic) zero-net-investment portfolio returns $F_j$, and parameter vector $\theta=(\alpha,\beta)$.
To avoid overfitting, we just test six simple SDF models that contain \{MKT\} alone or \{MKT\} plus \{ME or IA or ROE or EG or Alpha\}.
In Equation \ref{eq:estimator}, we use the quadratic loss function $L(x)=x^2$.

To assess the parameter significance, we compute the asymptotic standard errors as outlined in Subsection \ref{sec:asymptotic_inference}.
For the Bartlett kernel's bandwidth $b_n=D$ we select 12 years, i.e., funds with absolute vintage year differences larger than 12 years are assumed to be independent.

Additionally, we want to test the finite - or, more honestly, small - sample parameter significance and the out-of-sample performance of our SDF models.
To account for the dependency between funds from adjacent vintage years caused by overlapping fund cash flows, we draw on $hv$-block cross-validation \citep{R00}.
Therefore, we form three partitions for several vintage year groups.
As larger validation sets are preferred for model selection, the validation set ($v$-block) always contains funds of three neighboring vintage years (e.g., 2000, 2001, 2002).
To reduce the dependency between training and validation set, we remove all funds from three-year-adjacent vintage years, i.e., the $h$-block (e.g., 1997, 1998, 1999, 2003, 2004, 2005).
Funds from the remaining vintage years enter the training set and are thus used for model estimation (e.g., 1985-1996, 2006-2019).
We apply ten-fold cross validation using the ten validation sets described in Table \ref{tab:hv_block_cv}.
This means we replace the bootstrap standard error calculation of \cite{DLP12} by $hv$-block cross-validation since the new method (i) accounts for near-epoch-dependence, (ii) focuses directly on the out-of-sample performance of the SDF models, and (iii) is computationally cheaper.

\textcolor{orange}{\textbf{TODO: Introduce bounds for $\alpha$!}}


\begin{table}[ht]
	\centering
	\resizebox{0.9\textwidth}{!}{%
	\begin{tabular}{lllll}
		training.before & $h$-block.before & $v$-block & $h$-block.after & training.after \\ 
		\hline
		estimation & remove & validation & remove & estimation \\ 
		\hline
		\hline
		start-1984 & 1985,1986,1987 & 1988,1989,1990 & 1991,1992,1993 & 1994-end \\ 
		start-1987 & 1988,1989,1990 & 1991,1992,1993 & 1994,1995,1996 & 1997-end \\ 
		start-1990 & 1991,1992,1993 & 1994,1995,1996 & 1997,1998,1999 & 2000-end \\ 
		start-1993 & 1994,1995,1996 & 1997,1998,1999 & 2000,2001,2002 & 2003-end \\ 
		start-1996 & 1997,1998,1999 & 2000,2001,2002 & 2003,2004,2005 & 2006-end \\ 
		start-1999 & 2000,2001,2002 & 2003,2004,2005 & 2006,2007,2008 & 2009-end \\ 
		start-2002 & 2003,2004,2005 & 2006,2007,2008 & 2009,2010,2011 & 2012-end \\ 
		start-2005 & 2006,2007,2008 & 2009,2010,2011 & 2012,2013,2014 & 2015-end \\ 
		start-2008 & 2009,2010,2011 & 2012,2013,2014 & 2015,2016,2017 & 2018-end \\ 
		start-2011 & 2012,2013,2014 & 2015,2016,2017 & 2018,2019,2020 & 2021-end \\ 
		\hline
		\hline
	\end{tabular}
	}
	\caption{Partitions used for $hv$-block cross-validation.}
	\label{tab:hv_block_cv}
\end{table}


\subsection{Simulation study}
\label{sec:simulation_study}

Our Monte Carlo experiments examine the following questions related to the bias and variance of our estimation methodology in finite samples.\footnote{As with each simulation study, it investigates the ability to identify the assumed data generating process rather than the corresponding SDF model.}
Is it beneficial to use vintage-year portfolios instead of individual funds?
Which SDF model performs better when we also use the corresponding data generating process (i.e., assume correct model specification)?
How is estimator precision affected by varying numbers of vintage years and cross-sectional units?
Which is the optimal set of discounting dates $\mathcal{T}$?


We use historical $q$-investment factors from 1986 to 2005 and simulate 20 funds for each of these 20 vintage years.
This means we condition our simulation analysis on realized $q$-investment factors paths (see the Macro-Conditioning Kernel discussion in Section \ref{sec:asset_pricing_pooled}).
Each fund contains 15 deals with equal investment amounts and exactly one divestment cash flow.
Deals are entered within the first five years of the fund lifetime following a discrete uniform distribution and afterward held between one to ten years again uniformly distributed.
The deal returns are generated by the simple linear or exponential affine SDF models described in Equations \ref{eq:linear_sdf} and \ref{eq:expaff_SDF}.
In the base case, we just use the MKT factor with $\beta_{\mathrm{MKT}}=1$ and in each month, add a normal i.i.d. error term with standard deviation $\sigma=0.2$ and zero mean.
Additionally, we test an intercept term $\alpha$ of -0.25\% per month and a high $\beta_{\mathrm{MKT}}$ of 2.5.
In the exponential affine case, we adjust the lognormally distributed error mean to zero by subtracting $0.5 \sigma^2$.
If a negative return exceeds -100\%, the company defaults with a zero exit cash flow.
In contrast, the error term in the simulations of \cite{DLP12} is more well-behaved as it follows a shifted lognormal distribution that, even with arbitrarily high error term variance, just allows for returns below say -99\%, if the market return is close to its lower bound (see equation 9 in their online appendix).
In our base case, the set of discounting dates $\mathcal{T}$ contains all months from the first cash flow to the maximum month 180.
To assess our estimator's bias and variance, we simulate 1000 test scenarios for vintage year portfolios and only 200 test cases when using individual funds due to the higher computational costs of simulating the individual fund cash flows.


\paragraph{Cross-sectional unit $i$:}

As presumed in Subsection \ref{sec:asymptotic_framework}, vintage year portfolio results appear to have lower bias and variance when compared to individual funds.
For the simple linear SDF and maximum month 180, the mean and standard deviation of the coefficient estimate $\hat{\beta}_{\mathrm{MKT}}$ is 1.016 (0.2) for the vintage year portfolio and 1.096 (0.376) for individual funds. 
More results are depicted in Figure \ref{fig:simulation_funds_vs_vyps}.
However, for individual funds, we only simulate 200 iterations due to the high computational cost.

This finding has two important implications:
On the one hand, vintage year portfolio formation can substantially decrease our estimator's bias and variance.
On the other hand, it also dramatically reduces the number of cross-sectional units and consequentially impairs the importance of asymptotic results.
These considerations may explain the choice of \cite{KN16} to use individual funds as cross-sectional units in their asymptotic SHAC framework to obtain smaller standard error estimates.

\begin{figure}[H]
	\centering
	\includegraphics[width=0.9\textwidth]{Figures/bias_comparison1}
	\caption{\textbf{Simulation ($\beta_{\textrm{MKT}}$, $\alpha$):} Base cases.}
	\label{fig:sim1}
\end{figure}



\paragraph{SDF model $\Psi$:}

In our base case with vintage year portfolios, the exponential affine SDF shows a mean and standard deviation of 1.011 (0.175) compared to the 1.016 (0.2) achieved by the simple linear SDF.
Generally, the exponential affine SDF model and the simple linear SDF model exhibit similar bias and variance, cf.\ panels A and B in Table \ref{tab:simulation_study}.
Figure \ref{fig:simulation_expaff_vs_simlin} visualizes the true $\beta=1$ case, which shows that the estimation results are not overly sensitive to the choice of the SDF model.

Moreover, the perceived superiority of exponential affine SDFs is probably rather theoretical than practical as other proponents also emphasize their universality mainly from a mathematical perspective without providing supportive empirical or simulation results \citep{GM07,BMP08}.

\begin{figure}[H]
	\centering
	\includegraphics[width=0.9\textwidth]{Figures/bias_comparison5}
	\caption{\textbf{Simulation ($\beta_{\textrm{MKT}}$, $\alpha$):} Exponential affine vs.\ linear models.}
	\label{fig:sim_exp_aff}
\end{figure}

% TODO: delete
%\begin{figure}
%	\centering
%	\includegraphics[width=0.9\textwidth]{Figures/spatial/Simulationexpaffvssimlin}
%	\caption{Simulation results comparing exponentially affine and simple linear SDF with true $\beta=1$ and vintage year portfolios (1000 simulation iterations).}
%	\label{fig:simulation_expaff_vs_simlin}
%\end{figure}


\paragraph{Varying vintages $V$ and portfolio sizes $n/V$:}

To test the effect of varying data sizes available for MKT factor estimation, we in/decrease the (i) number of vintage years and (ii) the number of funds per vintage year (cf. Figures \ref{fig:sim_vary_vin_sizes} and \ref{fig:sim_vary_vin_sizes_alpha}).
Here we use vintage year portfolios and the simple linear SDF.
For our simple data generating process, increasing the number of deals/funds per vintage year portfolio appears to decrease the estimator's variance more effectively than adding more vintage years.
However, the bias is almost the same for all tested specifications.
Generally, we seem to need many new data points to ensure a reasonable variance of our estimator.


\begin{figure}[H]
	\centering
	\includegraphics[width=0.9\textwidth]{Figures/bias_comparison3}
	\caption{\textbf{Simulation ($\beta_{\textrm{MKT}}$, $\alpha$):} Varying vintages $V$ and portfolio sizes $n/V$.}
	\label{fig:sim_vary_vin_sizes_alpha}
\end{figure}

\begin{figure}[H]
	\centering
	\includegraphics[width=0.9\textwidth]{Figures/bias_comparison2}
	\caption{\textbf{Simulation ($\beta_{\textrm{MKT}}$):} Varying vintages $V$ and portfolio sizes $n/V$.}
	\label{fig:sim_vary_vin_sizes}
\end{figure}



\paragraph{Two-factor models ($q^5$ factors):}

For the $q^5$-factor models from Figure \ref{fig:sim_q_factors}, we most notably see that the standard deviation of the $\beta_{\mathrm{MKT}}$-factor estimates in the two-factors models appear high for all horizons, especially for the $ROE$ and $EG$ models.

For the $ME+MKT$ factor model, the mean $MKT$ factor estimate drops from $1.15$ for the 0-year horizon to $0.83$ for the 30-year horizon crossing the true $\beta_{\mathrm{MKT}}=1$ line at around the 15-year horizon.
The $ME$ factor varies from $0.86$ for the 0-year horizon to $-0.02$ for the 30-year horizon crossing the true parameter line $\beta_{\mathrm{ME}}=0.5$ at around the 17.5-year horizon.
The notable thing here is ...

For the $IA+MKT$ factor model, ...

For the $ROE+MKT$ factor model, ...

For the $EG+MKT$ factor model, ...

\begin{figure}[H]
	\centering
	\includegraphics[width=0.9\textwidth]{Figures/bias_comparison4}
	\caption{\textbf{Simulation ($q^5$ factors):} Two-factor models using VYP.}
	\label{fig:sim_q_factors}
\end{figure}


\paragraph{Size of set $\mathcal{T}$:}

This is the big question of the simulations study!
Which max compounding horizon is the optimal one?
From our diverse simulation results, we can deduce that we cannot determine the optimal horizon from these simulation results.

{\color{red}
The results in Table \ref{tab:simulation_study} indicate that we can control the asymptotic bias by an appropriate choice of the set $\mathcal{T}$.
For the one-factor model, the bias almost vanishes when we average over all discounting dates in the maximal fund lifetime of 180 months. 
For smaller or larger sets for $\mathcal{T}$, we find increasing bias terms.
Recall that using the minimal set for $\mathcal{T}$, i.e., discounting all cash flows just to the fund inception date, corresponds exactly to the \cite{DLP12} approach. 
Thus, the original \cite{DLP12} methodology might achieve a suboptimal asymptotic bias since it does not average pricing errors over multiple discounting dates.

The same finding also holds when we limit the maximal fund lifetime to ten years by reducing the maximum deal holding period from ten to five years. 
Here, under correct model specification with $\beta_{\mathrm{MKT}}=1$ , the smallest bias is obtained for maximum month 120, for max. month 60 we get 1.028 (0.116), for max. month 120, we get 1.005 (0.116), and for max. month 180 we get 0.969 (0.13).
However, this simulation results only hold for the one-factor model (MKT) reported here. 
For multi-factor models, smaller max. month values can yield the lowest bias term.
Thus, our simulation study could not reveal a formula how to determine the optimal set of $\mathcal{T}$; it seems to be data and SDF model dependent. 

In Table \ref{tab:simulation_study} for both true and false model specifications, the $\alpha$ standard deviation is very high compared to its mean value.
This may indicate it is rather delicate to empirically determine private equity's historical outperformance by our semiparametric estimator. \newline
}

\paragraph{Simulation conclusion:}
To conclude, our simulations study rationalizes two key practices from the \cite{DLP12} paper: (i) vintage year portfolio formation helps to improve estimator precision, and (ii) increasing the number of funds per vintage seems to be more effective in controlling estimator variance than increasing the number of vintages\footnote{Finding (ii) may explain the choice of \cite{DLP12} to employ an asymptotic law that lets the number of deals/funds per vintage tend to infinity.}.
However, our examples with correct specification cannot support the assumption of \cite{KN16} that (iii) the exponential affine SDF is (clearly) superior to the simple liner SDF in a multi-period framework; actually, their bias and variances are quite equal.
Moreover, our simulation study suggests that (iv) averaging pricing errors over multiple dates strikingly reduces the bias inherent to the original procedure of \cite{DLP12} that just discounts all cash flows to the fund inception date.
Actually, choosing the set $\mathcal{T}$ according to the fund lifetime seems to decrease the bias (and to a lesser extent also the variance) more effectively than all other measures combined.


\subsection{Empirical results}

Following the conclusions from the previous subsection, we use vintage-year portfolios to estimate simple linear SDF models with maximum month 180.
Asymptotic inference results for the full dataset are exhibited in Table \ref{tab:ai_180_FW_VYP_SL} for fund-size weighting and in Table \ref{tab:ai_180_EW_VYP_SL} for equal weighting.
The results for $hv$-block cross-validation are displayed in Table \ref{tab:cv_180_FW_VYP_SL} for fund-size weighting and in Table \ref{tab:cv_180_EW_VYP_SL} for equal weighting.
We generally analyze the results in a two-step procedure: For a given model specification, we use the cross-validation error (i.e., the average out-of-sample error) to select the best model for each fund type but analyze the corresponding coefficient estimates from the asymptotic inference tables (estimated on the entire data set).
Therefore, for each fund type the SDF models in the asymptotic inference Tables \ref{tab:ai_180_FW_VYP_SL} and \ref{tab:ai_180_EW_VYP_SL} are sorted by the corresponding cross-validation error.
Throughout this subsection, we define the statistical significance of coefficient estimates in terms of a $t$-ratio $\hat{\theta}[SE(\hat{\theta})]^{-1}$ greater than 1.96.

\begin{figure}
	\centering
	\includegraphics[width=0.9\textwidth]{Figures/empirical_PE_all_factors}
	\caption{\textbf{Empirical ($q^5$ factors):} Two-factor models for PE using VYP.}
	\label{fig:empirical}
\end{figure}


Table \ref{tab:ai_sum_abs} helps to get a rough overview of Table \ref{tab:ai_180_FW_VYP_SL} to \ref{tab:cv_180_EW_VYP_SL} as it summarizes their absolute column means.
Conspicuously, asymptotic standard errors (SEs) seem enormously high and, moreover, contain colossal outliers.
The standard errors implied by $hv-$block cross-validation are considerably smaller than the asymptotic SEs and seem to lie within a plausible range.
When just looking at asymptotic standard errors of the second factors, fund-size weighting exhibits substantially larger SEs than fund equal-weighting.
Assuming independence between funds from different vintages decreases asymptotic SEs by approximately 30-40\% compared to a realistic kernel bandwidth of $D=12$.
But even these independent SEs rarely imply statistical significance coefficient estimates with $t$-ratios bigger than 1.96.
In Table \ref{tab:ai_180_FW_VYP_SL} with fund-size weighting, just one out of 36 models exhibit asymptotically significant MKT and second-factor estimates.
In the case of equal-weighting, Table \ref{tab:ai_180_EW_VYP_SL} also shows just one asymptotically significant model out of 36.

In summary, the results reveal weak two-factor models with MKT plus a second $q$-investment factor. 
Likewise, the simulation results from the previous subsection indicate a rather high variance associated with our semiparametric estimator (given the amount of data typically available).
Thus, we recommend focusing on single MKT factor models even when their asymptotic t-ratios are below 1.96.
At least the $hv$-block cross-validation standard deviations imply significant one-factor MKT models for fund types PE, VC, PD, INF.
In contrast, RE is just significant for equal weighting, and NR is insignificant for both weighting schemes.

\paragraph{Treating NAVs as true value proxies}

Does this work?

\textcolor{orange}{\textbf{TODO: adapt estimator to neglect realized cash flows and use NAVs instead}}



\paragraph{Single market-factor models}

\paragraph{Two-factor models}

\paragraph{Focus on varying vintage cutoffs}

Our standard vintage year cutoff in our empirical Preqin dataset is 2019.
In this section, we  analyze how altering the maximum vintage cutoff from 2019 to older vintages influences the parameter estimates.
Concretely, we compare yearly cutoff-vintages from 2019 to 2011 making it 9 distinct cutoff dates.
We only consider asymptotic estimates in this section, i.e., we did not perform cross-validation results for the different vintage cutoffs.

Figure XXX shows ...

\paragraph{Focus on PE and VC estimates}

Here, we briefly summarize the one-factor MKT and the two-factor Alpha model estimates for fund types PE (i.e., mainly Buyout and Growth) and VC.
For PE, all one-factor MKT model $\beta_{\mathrm{MKT}}$ estimates fall in the range from 1.13 to 1.28. 
If we add an $\alpha$ term, all $\beta_{\mathrm{MKT}}$ estimates decrease to the range 0.61 to 0.77 with annualized $\alpha$ coefficients of approximately positive 4-5\% per year.
For VC, the one-factor MKT model $\beta_{\mathrm{MKT}}$ estimates are in the range from 0.80 to 1.14.
If we add an $\alpha$ term, all $\beta_{\mathrm{MKT}}$ estimates strongly increase to the range 1.81 to 2.06 with annualized $\alpha$ coefficients of approximately negative 6-7\% per year.
These results at least weakly indicate - given their insignificant asymptotic standard errors - that PE funds outperform public markets with a market beta coefficient of less than one, which suggests low market risk.
On the other hand, VC underperforms public markets with market beta coefficients of roughly two, which implies high market risk.
So, even \cite{DLP12} use the problematic Thomson Venture Economics (TVE) dataset for their empirical analysis\footnote{\cite{HJK14} discuss the potential downward bias of the TVE dataset.}, we obtain similar quantitative and qualitative results using Preqin data: (i) the market beta of VC seems to be higher than that of PE, and (ii) VC, in contrast to PE, appears to exhibit a negative abnormal performance $\alpha$\footnote{Similarly, \cite[Exhibit 4.6]{MY10} find high beta coefficients (1.63 and 2.04) and small to negative alphas (-2.11\% and 0.13\%) for VC funds in their lag-return regression.}.

As a robustness check, we reestimate all SDF models on a dataset that just contains funds from vintages older or equal than 2011.
Interestingly, the PE and VC results regarding $\beta_{\mathrm{MKT}}$ and $\alpha$ can be qualitatively and also quantitatively confirmed on this 'mostly-liquidated' dataset\footnote{All R code and data is available in an online repository. \url{https://github.com/quant-unit/Fundwise_SDF/tree/master/r_project}
}.

% latex table generated in R 3.4.2 by xtable 1.8-4 package
% Mon Jun  8 17:19:54 2020
\begin{table}[H]
	\centering
	\begin{tabularx}{0.9\textwidth}{l|XXX|lXXX}
			& \multicolumn{3}{l}{MKT Factor} & \multicolumn{4}{l}{Second Factor} \\ 
			Type & Estim. & SE & SE.indep & Factor & Estim. & SE & SE.indep \\ 
			\hline
			\hline
			PE & 0.709 & 2.470 & 1.153 & EG & 0.807 & 4.693 & 1.960 \\ 
			PE & 0.770 & 7.976 & 3.348 & ROE & 1.540 & 5.140 & 3.499 \\ 
			PE & 1.126 & 1.003 & 0.868 & MKT & 1.126 & 1.003 & 0.868 \\ 
			PE & 0.644 & 1.234 & 0.585 & Alpha & 0.003 & 0.036 & 0.013 \\ 
			PE & 1.121 & 1.023 & 0.897 & ME & 0.074 & 2.021 & 0.915 \\ 
			PE & 1.158 & 1.125 & 1.068 & IA & -0.338 & 2.499 & 1.259 \\
			\hline 
			VC & 1.053 & 4.150 & 2.733 & IA & -1.959 & 2.100 & 1.767 \\ 
			VC & 1.114 & 3.861 & 2.894 & ME & -1.383 & 5.102 & 2.211 \\ 
			VC & 1.806 & 11.391 & 4.279 & Alpha & -0.006 & 0.124 & 0.046 \\ 
			VC & 0.801 & 704.455 & 561.598 & MKT & 0.801 & 704.455 & 561.598 \\ 
			VC & 1.429 & 8.073 & 3.219 & ROE & -1.306 & 18.055 & 6.919 \\ 
			VC & 1.507 & 17.322 & 6.966 & EG & -0.904 & 15.344 & 5.737 \\ 
			%\hline
			%PD & 0.885 & 1.040 & 1.242 & MKT & 0.885 & 1.040 & 1.242 \\ 
			%PD & 0.660 & 0.095 & 0.039 & Alpha & 0.002 & 0.001 & 0.000 \\ 
			%PD & 0.826 & 1.707 & 1.443 & EG & 0.143 & 20.341 & 7.506 \\ 
			%PD & 0.849 & 2.921 & 2.146 & ME & 0.301 & 2.739 & 1.518 \\ 
			%PD & 0.887 & 1.378 & 1.244 & ROE & -0.023 & 6.925 & 2.553 \\ 
			%PD & 0.863 & 2.942 & 2.224 & IA & 0.247 & 5.306 & 3.607 \\ 
			%\hline
			%RE & 0.578 & 1.827 & 1.196 & MKT & 0.578 & 1.827 & 1.196 \\ 
			%RE & 1.303 & 5.463 & 2.259 & Alpha & -0.006 & 0.088 & 0.034 \\ 
			%RE & 0.200 & 2.598 & 1.356 & ROE & 3.118 & 2.579 & 6.629 \\ 
			%RE & 0.202 & 3.297 & 1.965 & EG & 0.844 & 2.478 & 1.828 \\ 
			%RE & 0.756 & 3.043 & 2.192 & IA & -1.938 & 1.879 & 0.783 \\ 
			%RE & 0.887 & 1.167 & 0.858 & ME & -2.059 & 1.300 & 0.563 \\ 
			%\hline
			%NR & -0.215 & 2.367 & 1.976 & EG & 0.909 & 14.505 & 7.475 \\ 
			%NR & 0.191 & 3.136 & 4.242 & MKT & 0.191 & 3.136 & 4.242 \\ 
			%NR & -0.674 & 58.003 & 24.234 & Alpha & 0.008 & 0.230 & 0.098 \\ 
			%NR & -0.020 & 0.954 & 2.210 & ROE & 1.128 & 4.830 & 5.066 \\ 
			%NR & 0.143 & 3.236 & 4.116 & IA & -0.768 & 1.808 & 2.154 \\ 
			%NR & 0.212 & 4.209 & 5.450 & ME & -0.575 & 1.603 & 1.252 \\ 
			%\hline
			%INF & 0.824 & 3.201 & 2.815 & MKT & 0.824 & 3.201 & 2.815 \\ 
			%INF & 0.190 & 7.133 & 3.288 & Alpha & 0.005 & 0.030 & 0.025 \\ 
			%INF & 0.317 & 23.904 & 10.658 & EG & 0.848 & 45.836 & 20.176 \\ 
			%INF & 0.470 & 9.316 & 4.237 & ROE & 1.245 & 5.531 & 6.134 \\ 
			%INF & 0.778 & 5.951 & 5.424 & ME & -0.811 & 3.712 & 4.349 \\ 
			%INF & 0.661 & 61.329 & 33.819 & IA & -1.108 & 150.713 & 85.733 \\ 
			\hline
			\hline
	\end{tabularx}
	\caption{
			Asymptotic inference using vintage-year portfolios with fund-size weighting, max month 180, and kernel bandwidth $D=12$.
			Standard Errors (SE) are calculated by Equation \ref{eq:asy_se}.
			} 
	\label{tab:ai_180_FW_VYP_SL}
\end{table}


\begin{table}[H]
	\centering
	\begin{tabularx}{0.9\textwidth}{l|XX|XlX|X}
			& \multicolumn{2}{l}{MKT Factor} & \multicolumn{3}{l}{Second Factor} & \\ 
			Type & Mean & SD & Factor & Mean & SD & CV error \\ 
			\hline
			\hline
			PE & 0.867 & 0.276 & EG & 0.720 & 0.137 & 112808 \\ 
			PE & 0.927 & 0.305 & ROE & 1.375 & 0.420 & 126801 \\ 
			PE & 1.276 & 0.296 & MKT & 1.276 & 0.296 & 151964 \\ 
			PE & 0.772 & 0.238 & Alpha & 0.004 & 0.002 & 154805 \\ 
			PE & 1.317 & 0.396 & ME & 0.236 & 0.664 & 209319 \\ 
			PE & 1.311 & 0.370 & IA & 0.014 & 0.703 & 210650 \\ 
			\hline
			VC & 1.045 & 0.126 & IA & -1.890 & 0.238 & 11858 \\ 
			VC & 1.172 & 0.126 & ME & -1.448 & 0.263 & 13301 \\ 
			VC & 1.930 & 0.356 & Alpha & -0.005 & 0.001 & 17723 \\ 
			VC & 0.804 & 0.363 & MKT & 0.804 & 0.363 & 21852 \\ 
			VC & 1.527 & 0.517 & ROE & -0.972 & 0.679 & 26680 \\ 
			VC & 1.646 & 0.678 & EG & -0.644 & 0.556 & 32730 \\ 
			%\hline
			%PD & 0.887 & 0.039 & MKT & 0.887 & 0.039 & 7368 \\ 
			%PD & 0.567 & 0.202 & Alpha & 0.003 & 0.001 & 7917 \\ 
			%PD & 0.763 & 0.113 & EG & 0.229 & 0.141 & 8758 \\ 
			%PD & 0.862 & 0.103 & ME & 0.342 & 0.256 & 9834 \\ 
			%PD & 0.812 & 0.153 & ROE & 0.258 & 0.394 & 11522 \\ 
			%PD & 0.914 & 0.211 & IA & 0.472 & 0.424 & 18096 \\
			%\hline 
			%RE & 0.722 & 0.392 & MKT & 0.722 & 0.392 & 50900 \\ 
			%RE & 1.288 & 0.345 & Alpha & -0.004 & 0.005 & 51437 \\ 
			%RE & 0.389 & 0.446 & ROE & 2.333 & 1.507 & 54689 \\ 
			%RE & 0.465 & 0.470 & EG & 0.448 & 0.629 & 59316 \\ 
			%RE & 0.847 & 0.411 & IA & -1.262 & 1.160 & 65835 \\ 
			%RE & 0.983 & 0.350 & ME & -1.467 & 1.298 & 66827 \\ 
			%\hline
			%NR & -0.047 & 0.421 & EG & 0.657 & 0.557 & 10559 \\ 
			%NR & 0.318 & 0.321 & MKT & 0.318 & 0.321 & 11480 \\ 
			%NR & -0.335 & 0.763 & Alpha & 0.006 & 0.005 & 11854 \\ 
			%NR & 0.136 & 0.466 & ROE & 0.844 & 1.062 & 13296 \\ 
			%NR & 0.270 & 0.508 & IA & -0.288 & 1.124 & 14479 \\ 
			%NR & 0.416 & 0.587 & ME & 0.032 & 1.079 & 15789 \\ 
			%\hline
			%INF & 0.862 & 0.320 & MKT & 0.862 & 0.320 & 14551 \\ 
			%INF & 0.639 & 0.753 & Alpha & 0.002 & 0.004 & 15069 \\ 
			%INF & 0.766 & 0.626 & EG & 0.258 & 0.495 & 16004 \\ 
			%INF & 0.837 & 0.504 & ROE & 0.090 & 0.939 & 18472 \\ 
			%INF & 0.868 & 0.412 & ME & 0.078 & 0.643 & 18514 \\ 
			%INF & 0.892 & 0.561 & IA & 0.081 & 1.073 & 23162 \\ 
			\hline
			\hline
	\end{tabularx}
	\caption{$hv$-block cross-validation using vintage-year portfolios with fund-size weighting and max month 180.} 
	\label{tab:cv_180_FW_VYP_SL}
\end{table}


% latex table generated in R 3.4.2 by xtable 1.8-4 package
% Mon Jun  8 17:44:27 2020
\begin{table}[H]
	\centering
	\begin{tabularx}{0.9\textwidth}{l|XXX|lXXX}
			& \multicolumn{3}{l}{MKT Factor} & \multicolumn{4}{l}{Second Factor} \\ 
			Type & Estim. & SE & SE.indep & Factor & Estim. & SE & SE.indep \\ 
			\hline
			\hline
			PE & 0.775 & 0.638 & 0.550 & EG & 0.667 & 5.558 & 2.125 \\ 
			PE & 0.610 & 1.064 & 0.387 & Alpha & 0.004 & 0.006 & 0.002 \\ 
			PE & 0.826 & 20.352 & 8.308 & ROE & 1.087 & 33.514 & 12.143 \\ 
			PE & 1.134 & 1.050 & 0.694 & MKT & 1.134 & 1.050 & 0.694 \\ 
			PE & 1.146 & 1.001 & 0.638 & IA & -0.386 & 1.909 & 0.813 \\ 
			PE & 1.134 & 1.048 & 0.702 & ME & -0.014 & 1.797 & 0.736 \\ 
			\hline
			VC & 1.181 & 24.418 & 16.693 & ME & -1.277 & 4.928 & 4.352 \\ 
			VC & 1.137 & 7.259 & 6.057 & IA & -1.553 & 3.716 & 2.139 \\ 
			VC & 1.956 & 4.189 & 1.520 & Alpha & -0.006 & 0.335 & 0.117 \\ 
			VC & 1.034 & 2.205 & 1.758 & MKT & 1.034 & 2.205 & 1.758 \\ 
			VC & 1.488 & 1.801 & 0.941 & ROE & -1.148 & 4.060 & 1.424 \\ 
			VC & 1.535 & 2.821 & 1.336 & EG & -0.754 & 3.626 & 1.260 \\ 
			%\hline
			%PD & 0.844 & 1.245 & 0.856 & MKT & 0.844 & 1.245 & 0.856 \\ 
			%PD & 0.502 & 0.044 & 0.015 & Alpha & 0.003 & 0.000 & 0.000 \\ 
			%PD & 0.791 & 2.478 & 1.557 & ROE & 0.222 & 5.024 & 1.966 \\ 
			%PD & 0.736 & 2.230 & 1.303 & EG & 0.213 & 6.296 & 2.374 \\ 
			%PD & 0.844 & 1.150 & 0.837 & IA & 0.076 & 2.543 & 1.416 \\ 
			%PD & 0.833 & 1.978 & 1.362 & ME & 0.323 & 1.845 & 0.986 \\ 
			%\hline
			%RE & 0.743 & 3.471 & 2.075 & MKT & 0.743 & 3.471 & 2.075 \\ 
			%RE & 1.265 & 7.581 & 3.331 & Alpha & -0.004 & 0.046 & 0.017 \\ 
			%RE & 0.145 & 3.486 & 1.614 & ROE & 3.202 & 17.447 & 7.413 \\ 
			%RE & 0.400 & 50.493 & 31.818 & EG & 0.700 & 48.813 & 29.195 \\ 
			%RE & 0.884 & 4.928 & 2.813 & ME & -1.782 & 1.474 & 0.605 \\ 
			%RE & 0.795 & 18.146 & 10.282 & IA & -1.712 & 13.199 & 7.657 \\ 
			%\hline
			%NR & -0.056 & 3.693 & 1.897 & ROE & 1.934 & 3.154 & 2.287 \\ 
			%NR & 0.000 & 4.771 & 2.368 & EG & 0.814 & 1.368 & 1.753 \\ 
			%NR & 0.425 & 3.370 & 5.178 & MKT & 0.425 & 3.370 & 5.178 \\ 
			%NR & -0.272 & 39.463 & 16.698 & Alpha & 0.006 & 0.202 & 0.081 \\ 
			%NR & 0.394 & 0.871 & 1.401 & IA & -0.319 & 1.734 & 1.169 \\ 
			%NR & 0.453 & 15.719 & 24.377 & ME & 0.432 & 5.574 & 8.016 \\ 
			%\hline
			%INF & 0.098 & 0.055 & 0.025 & Alpha & 0.006 & 0.001 & 0.000 \\ 
			%INF & 0.280 & 20.158 & 8.983 & EG & 0.893 & 21.368 & 9.700 \\ 
			%INF & 0.775 & 19.273 & 22.509 & MKT & 0.775 & 19.273 & 22.509 \\ 
			%INF & 0.469 & 26.226 & 12.751 & ROE & 1.030 & 30.728 & 16.129 \\ 
			%INF & 0.758 & 33.453 & 36.239 & ME & -0.804 & 16.214 & 16.161 \\ 
			%INF & 0.664 & 630.801 & 351.730 & IA & -0.929 & 137.937 & 75.628 \\ 
			\hline
			\hline
	\end{tabularx}
	\caption{
		Asymptotic inference using vintage-year portfolios with fund-equal weighting, max month 180, and kernel bandwidth $D=12$.
		Standard Errors (SE) are calculated by Equation \ref{eq:asy_se}.
		} 
	\label{tab:ai_180_EW_VYP_SL}
\end{table}

% latex table generated in R 3.4.2 by xtable 1.8-4 package
% Mon Jun  8 17:44:27 2020
\begin{table}[H]
	\centering
	\begin{tabularx}{0.9\textwidth}{l|XX|XlX|X}
			& \multicolumn{2}{l}{MKT Factor} & \multicolumn{3}{l}{Second Factor} & \\ 
			Type & Mean & SD & Factor & Mean & SD & CV error \\ 
			\hline
			\hline
			PE & 0.886 & 0.262 & EG & 0.614 & 0.217 & 101444 \\ 
			PE & 0.719 & 0.205 & Alpha & 0.004 & 0.001 & 105842 \\ 
			PE & 0.948 & 0.267 & ROE & 0.975 & 0.407 & 110926 \\ 
			PE & 1.250 & 0.262 & MKT & 1.250 & 0.262 & 127589 \\ 
			PE & 1.247 & 0.274 & IA & -0.183 & 0.598 & 157037 \\ 
			PE & 1.281 & 0.323 & ME & 0.048 & 0.644 & 169552 \\ 
			\hline
			VC & 1.250 & 0.153 & ME & -1.292 & 0.234 & 16305 \\ 
			VC & 1.183 & 0.169 & IA & -1.507 & 0.327 & 16449 \\ 
			VC & 2.052 & 0.257 & Alpha & -0.006 & 0.001 & 18666 \\ 
			VC & 1.138 & 0.341 & MKT & 1.138 & 0.341 & 25321 \\ 
			VC & 1.610 & 0.431 & ROE & -0.946 & 0.426 & 26618 \\ 
			VC & 1.688 & 0.505 & EG & -0.616 & 0.331 & 30392 \\ 
			%\hline
			%PD & 0.838 & 0.029 & MKT & 0.838 & 0.029 & 11290 \\ 
			%PD & 0.458 & 0.151 & Alpha & 0.003 & 0.001 & 11568 \\ 
			%PD & 0.770 & 0.058 & ROE & 0.232 & 0.111 & 11572 \\ 
			%PD & 0.707 & 0.086 & EG & 0.224 & 0.091 & 12194 \\ 
			%PD & 0.825 & 0.083 & IA & 0.158 & 0.305 & 15071 \\ 
			%PD & 0.837 & 0.098 & ME & 0.358 & 0.328 & 15441 \\ 
			%\hline
			%RE & 0.803 & 0.336 & MKT & 0.803 & 0.336 & 43486 \\ 
			%RE & 1.191 & 0.363 & Alpha & -0.003 & 0.004 & 45310 \\ 
			%RE & 0.341 & 0.402 & ROE & 2.275 & 1.558 & 52822 \\ 
			%RE & 0.559 & 0.379 & EG & 0.397 & 0.503 & 52867 \\ 
			%RE & 0.929 & 0.339 & ME & -1.287 & 1.174 & 57341 \\ 
			%RE & 0.852 & 0.372 & IA & -1.129 & 1.025 & 57662 \\ 
			%\hline
			%NR & -0.009 & 0.203 & ROE & 1.880 & 0.562 & 15631 \\ 
			%NR & 0.200 & 0.510 & EG & 0.681 & 0.372 & 18981 \\ 
			%NR & 0.572 & 0.400 & MKT & 0.572 & 0.400 & 20006 \\ 
			%NR & -0.065 & 0.729 & Alpha & 0.006 & 0.004 & 20880 \\ 
			%NR & 0.596 & 0.567 & IA & -0.060 & 0.869 & 24766 \\ 
			%NR & 0.769 & 0.771 & ME & 0.666 & 1.062 & 27238 \\ 
			%\hline
			%INF & 0.124 & 0.608 & Alpha & 0.007 & 0.006 & 14995 \\ 
			%INF & 0.613 & 0.393 & EG & 0.402 & 0.496 & 15758 \\ 
			%INF & 0.862 & 0.281 & MKT & 0.862 & 0.281 & 15820 \\ 
			%INF & 0.627 & 0.360 & ROE & 0.577 & 1.374 & 18297 \\ 
			%INF & 0.810 & 0.315 & ME & -0.129 & 1.109 & 19641 \\ 
			%INF & 0.797 & 0.842 & IA & 0.051 & 2.180 & 33661 \\ 
			\hline
			\hline
	\end{tabularx}
	\caption{$hv$-block cross-validation using vintage-year portfolios with fund-equal weighting and max month 180.} 
	\label{tab:cv_180_EW_VYP_SL}
\end{table}


% NEW NEW NEW


\pagebreak












\section{Conclusion}
\label{sec:spatial_sdf_conclusion}

Theoretically, our Least-Mean-Distance estimator can be easily generalized to estimate SDF models for all kinds of non-traded cash flows.
Practically, semiparametric estimators commonly exhibit problematic small sample behavior.
Given the amount of currently available private equity fund data, our estimator's variance seems quite large, even for simple SDF model specifications.
Specifically, our Monte Carlo simulation results prompt us to conclude that the closely related \cite{DLP12} estimator may exhibit more bias and variance than originally assumed in their paper.
Especially, the variance of $\alpha$ estimates seems to be too high to allow reliable abnormal performance conclusions.
Fortunately, we show that at least the bias can be easily reduced by averaging pricing errors over all dates within the fund lifetime.

In the data-sparse private equity domain with only 20-40 cross-sectional units (i.e., vintage year portfolios) currently available for estimation, asymptotic inference seems not to be overly useful.
Thus, we strongly advise always challenging asymptotic inference results by resampling or cross-validation techniques adapted to the dependence structure of overlapping fund cash flows.
However, even these conclusions should be double-checked to avoid unreasonable instances, e.g., when $hv$-block cross-validation chooses dubious models with negative MKT factor estimates.
Unfortunately, using individual funds instead of vintage year portfolios, which yields smaller asymptotic standard errors, constitutes no viable resolution as individual funds show considerably larger small-sample bias and variance in our Monte Carlo example.
Since, in our empirical analyses, basically all two-factor models' asymptotic standard errors appear statistically insignificant, we conjecture that naive versions of our SDF estimator shall be exclusively used for a single-MKT-factor model until considerably more vintage year information for private equity funds is available.

If someone wants to estimate more complex SDF models that incorporate additional factors, more structure is needed.
These can be parametric assumptions for the data generating process \citep{ACGP18} or to extract additional information from intermediate net asset values \citep{GSW19,BGG20}.
A first "modern" approach to the same problem is applying machine learning techniques that regularize/shrink all coefficients other than the MKT factor.
Secondly, given the high estimator variance revealed in the simulation study, statistical learning methods that create a strong learner by combining multiple weak learners seem also worth considering (boosting, bagging, or model averaging).

\marginpar{\scriptsize Incorporate fees and carry model to DGP for SDF estimation for PE gross-fee performance}

Finally, we point to the potentially most interesting topic for future research.
Our simulation study indicates that the estimator's bias and variance can be controlled by an appropriate choice for the set $\mathcal{T}$.
This set averages the pricing error over multiple discounting dates.
In simpler terms, an identification method that utilizes a future value concept instead of net present values obtains more favorable results in our case.
The bias in our simulation study is minimal when the set of discounting dates corresponds to the fund lifetime.
A parsimonious but general model that allows for misspecification and can explain this $\mathcal{T}$-averaging effect from a mathematical perspective would be highly appreciated.
% Appendix



%% References
\bibliographystyle{apalike}
\bibliography{ref.bib}

%\newpage

% Appendix
\appendix

\section{Bias--Variance Tradeoff of $\mathcal{T}$-Averaging}
\label{sec:appendix_bias_variance}

This appendix provides a formal decomposition of the bias introduced by averaging pricing errors over multiple discounting dates (Equation~\ref{eq:average_pricing_error}) and explains the bias-reduction mechanism observed in the simulation study (Section~\ref{sec:simulation_study}).

\subsection{Decomposition of $\mathbb{E}[\bar{\epsilon}_i(\theta_0)]$}

Starting from the average pricing error (Equation~\ref{eq:average_pricing_error}) and the deal-level decomposition (Equation~\ref{eq:deal_pricing_error}), we can write
\begin{equation}
	\label{eq:avg_eps_deal_decomp}
	\bar{\epsilon}_i(\theta_0)
	= \frac{1}{|\mathcal{T}_i|}
	\sum_{\tau \in \mathcal{T}_i}
	\epsilon_{\tau,i}(\theta_0)
	= \frac{1}{|\mathcal{T}_i|}
	\sum_{\tau \in \mathcal{T}_i}
	\sum_{j=1}^J
	\frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_\tau}\,
	\delta_{i,j}
\end{equation}

Taking the unconditional expectation yields
\begin{equation}
	\label{eq:unconditional_bias}
	\mathbb{E}[\bar{\epsilon}_i(\theta_0)]
	= \frac{1}{|\mathcal{T}_i|}
	\sum_{\tau \in \mathcal{T}_i}
	\sum_{j=1}^J
	\mathbb{E}\!\left[
	\frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_\tau}\,
	\delta_{i,j}
	\right]
\end{equation}

For each $(\tau, j)$ pair, we decompose via the covariance identity:
\begin{equation}
	\label{eq:cov_decomp}
	\mathbb{E}\!\left[
	\frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_\tau}\,
	\delta_{i,j}
	\right]
	=
	\underbrace{
		\mathrm{Cov}\!\left(
		\frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_\tau},\,
		\delta_{i,j}
		\right)
	}_{\mathrm{TRP}_{\tau,j}}
	+
	\underbrace{
		\mathbb{E}\!\left[
		\frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_\tau}
		\right]
	}_{> 0}
	\cdot
	\underbrace{
		\mathbb{E}[\delta_{i,j}]
	}_{= 0}
\end{equation}

Hence the asymptotic bias of the average pricing error is entirely determined by the averaged Timing Risk Premium:
\begin{equation}
	\label{eq:bias_trp}
	\mathbb{E}[\bar{\epsilon}_i(\theta_0)]
	= \frac{1}{|\mathcal{T}_i|}
	\sum_{\tau \in \mathcal{T}_i}
	\sum_{j=1}^J
	\mathrm{Cov}\!\left(
	\frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_\tau},\,
	\delta_{i,j}
	\right)
\end{equation}

The crucial observation is that this covariance is exactly zero when $\tau \leq t_{i,j}^{\mathrm{Inv}}$ (Case~A from Section~\ref{sec:asset_pricing_pooled}).
When $\tau \leq t_{i,j}^{\mathrm{Inv}}$, iterated expectations through $\mathcal{F}_{t_{i,j}^{\mathrm{Inv}}}$ give
\begin{equation}
	\mathrm{Cov}\!\left(
	\frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_\tau},\,
	\delta_{i,j}
	\right)
	=
	\mathbb{E}\!\left[
	\frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_\tau}\,
	\underbrace{
		\mathbb{E}\!\left[
		\delta_{i,j}
		\mid \mathcal{F}_{t_{i,j}^{\mathrm{Inv}}}
		\right]
	}_{= 0 \text{ by Eq.~\ref{eq:deal_pricing}}}
	\right]
	= 0
\end{equation}

Therefore the bias decomposes as
\begin{equation}
	\label{eq:bias_npv_nfv}
	\mathbb{E}[\bar{\epsilon}_i(\theta_0)]
	= \frac{1}{|\mathcal{T}_i|}
	\left[
	\underbrace{
		\sum_{\substack{\tau \in \mathcal{T}_i,\, j \\[2pt] \tau \leq t_{i,j}^{\mathrm{Inv}}}}
		0
	}_{\text{NPV terms}}
	\;+\;
	\underbrace{
		\sum_{\substack{\tau \in \mathcal{T}_i,\, j \\[2pt] \tau > t_{i,j}^{\mathrm{Inv}}}}
		\mathrm{Cov}\!\left(
		\frac{\Psi_{t_{i,j}^{\mathrm{Inv}}}}{\Psi_\tau},\,
		\delta_{i,j}
		\right)
	}_{\text{NFV terms (Timing Risk Premium)}}
	\right]
\end{equation}


\subsection{Reconciliation with the simulation study}

If this asymptotic bias were the only effect, the NPV-only approach of \cite{DLP12} with $\mathcal{T}_i = \{\min_j t_{i,j}^{\mathrm{Inv}}\}$ would exhibit the smallest bias, and adding NFV terms would always increase it.
However, the simulation study in Section~\ref{sec:simulation_study} shows the opposite: averaging over larger $\mathcal{T}_i$ \emph{reduces} total bias. The resolution involves two competing effects.

\paragraph{Effect 1: Finite-sample bias from nonlinear estimation}

For the nonlinear least-squares objective $Q_n(\theta) = -\frac{1}{n}\sum_{i=1}^n \bar{\epsilon}_i(\theta)^2$, the finite-sample bias of $\hat{\theta}$ is approximately (standard Nagar-type expansion for M-estimators):
\begin{equation}
	\label{eq:finite_sample_bias}
	\mathbb{E}[\hat{\theta} - \theta_0]
	\approx
	-\frac{1}{n}\, H^{-1} \cdot b\!\left(
	\mathrm{Var}[\bar{\epsilon}_i],\, \text{curvature}
	\right)
\end{equation}
where $b$ is a correction term that is proportional to $\mathrm{Var}[\bar{\epsilon}_i(\theta_0)]$.
When each fund provides only one noisy moment (NPV-only), this variance is high and creates a substantial finite-sample bias through the curvature of the quadratic loss.

\paragraph{Effect 2: Variance reduction through $\mathcal{T}$-averaging}

When averaging over $|\mathcal{T}_i|$ discounting dates, the variance of the average pricing error is
\begin{equation}
	\label{eq:var_avg_eps}
	\mathrm{Var}[\bar{\epsilon}_i]
	= \frac{1}{|\mathcal{T}_i|^2}
	\sum_{\tau, \tau' \in \mathcal{T}_i}
	\mathrm{Cov}\!\left(
	\epsilon_{\tau,i},\,
	\epsilon_{\tau',i}
	\right)
\end{equation}

The pricing errors $\epsilon_{\tau,i}$ at different $\tau$ are positively correlated (they share the same deal cash flows and factor realizations), but they are not perfectly correlated because different $\tau$'s weight the SDF path differently.
Hence
\[
\mathrm{Var}[\bar{\epsilon}_i]
< \mathrm{Var}[\epsilon_{\tau_0,i}]
\quad \text{for } |\mathcal{T}_i| > 1
\]
and this variance reduction directly decreases the finite-sample bias from the nonlinear optimization (cf.\ Equation~\ref{eq:finite_sample_bias}).

\paragraph{The net effect}

The total bias in small samples decomposes approximately as
\[
\underbrace{
	\text{Finite-sample bias}
}_{\propto\, \mathrm{Var}[\bar{\epsilon}_i] / n}
\;+\;
\underbrace{
	\text{Asymptotic TRP bias}
}_{\text{Eq.~\ref{eq:bias_npv_nfv}}}
\]

As $|\mathcal{T}_i|$ increases from one:
\begin{itemize}
	\item The finite-sample bias \emph{decreases} because $\mathrm{Var}[\bar{\epsilon}_i]$ drops, i.e., each fund contributes more information to the objective function.
	\item The TRP bias \emph{increases} (more NFV terms enter), but slowly because:
	\begin{itemize}
		\item only the fraction of $(\tau,j)$ pairs with $\tau > t_{i,j}^{\mathrm{Inv}}$ contributes,
		\item under correct model specification, the TRP covariance is non-zero as it is driven by the interaction of systematic risk (i.e., beta) with the SDF path, but this bias effectively remains small relative to the variance reduction,
		\item the $1/|\mathcal{T}_i|$ denominator dilutes the accumulating TRP terms.
	\end{itemize}
\end{itemize}

The simulation study finds the sweet spot where these two effects balance: at $|\mathcal{T}_i|$ corresponding to approximately the fund lifetime (180 months), the variance-reduction benefit dominates the TRP cost.

\subsection{Interpretation}

The $\mathcal{T}$-averaging mechanism does not make the TRP ``wash out'' in the sense that each individual TRP term goes to zero.
Rather, it achieves a bias--variance tradeoff where the small TRP bias introduced by NFV terms is more than compensated by the variance reduction that cures the finite-sample bias inherited from the nonlinear estimation.
The TRP terms are ``diluted'' by the growing denominator $|\mathcal{T}_i|$. Although they do not vanish (as they are driven by systematic risk), they remain small enough relative to the substantial variance reduction that cures the finite-sample bias inherited from the nonlinear estimation.

The fact that the optimal $|\mathcal{T}_i|$ depends on the SDF model is consistent with this explanation: a more complex or misspecified SDF model would increase the TRP covariance terms, shifting the optimal tradeoff point.


%\input{literature.tex}
%\input{theory.tex}
%\input{asymptotic_theory.tex}
%\input{appendix_tables.tex}


\end{document}